<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrisam's Test!</title>

    <!-- Embedded CSS Styles -->
    <style>
        /* Use the imported Lato font */
        body {
            font-family: 'Lato', sans-serif;
            background-color: #eef2f7;
            /* Light, cool background */
            color: #333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background-color: #ffffff;
            /* White container background */
            padding: 30px;
            border-radius: 8px;
            /* Subtle rounding */
            text-align: center;
            max-width: 650px;
            /* Wider container */
            width: 100%;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            /* Clean shadow */
        }

        #lesson-selection.container {
            padding: 40px 30px;
        }

        #lesson-selection h2 {
            color: #1a2a6c;
            /* Deep blue */
            margin-bottom: 30px;
            font-size: 2.2em;
            font-weight: 900;
            /* Lato Black */
        }

        .action-button {
            background-color: #4a69bd;
            /* Muted blue */
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            margin: 8px;
            transition: background-color 0.2s ease, transform 0.1s ease;
            font-weight: 700;
            /* Lato Bold */
            text-transform: uppercase;
        }

        .action-button:hover:not(:disabled) {
            background-color: #3b5998;
            /* Darker blue on hover */
            transform: translateY(-2px);
        }

        .action-button:active:not(:disabled) {
            transform: translateY(0);
        }

        .action-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Specific style for the skip button */
        #skip-button {
            background-color: #6c757d;
            /* Muted grey */
            margin-top: 15px;
            /* Space above skip button */
            margin-bottom: 15px;
            /* Space below skip button before separator/next */
        }

        #skip-button:hover:not(:disabled) {
            background-color: #5a6268;
            /* Darker grey on hover */
        }

         /* Specific style for the reveal answer button */
         #reveal-answer-button {
             background-color: #17a2b8; /* Info blue */
             margin-top: 15px;
             margin-bottom: 15px;
         }
         #reveal-answer-button:hover:not(:disabled) {
             background-color: #138496; /* Darker info blue */
         }


        /* Style for the "Add to Remember" button */
        #add-to-remember-button {
            background-color: #ffc107;
            /* Orange/Yellow */
            color: #343a40;
            /* Dark text */
            font-size: 0.9em;
            /* Slightly smaller */
            padding: 8px 15px;
            margin-top: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        #add-to-remember-button:hover:not(:disabled) {
            background-color: #e0a800;
            /* Darker orange */
        }

        #add-to-remember-button:disabled {
            /* Use a lighter version of its own color */
            background-color: #cccccc; /* Grey color for disabled remember button */
            color: #666; /* Dark grey text */
            cursor: not-allowed;
        }

         /* Style for self-correction buttons (Right/Wrong) */
        .self-correct-button {
            background-color: #28a745; /* Green for Right */
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            margin: 8px;
            transition: background-color 0.2s ease, transform 0.1s ease;
            font-weight: 700;
            text-transform: uppercase;
        }

        .self-correct-button.wrong {
             background-color: #dc3545; /* Red for Wrong */
        }

        .self-correct-button:hover:not(:disabled) {
             background-color: #218838; /* Darker green */
             transform: translateY(-2px);
        }

        .self-correct-button.wrong:hover:not(:disabled) {
             background: #c82333; /* Darker red */
             transform: translateY(-2px);
        }

        .self-correct-button:active:not(:disabled) {
             transform: translateY(0);
        }

        .self-correct-button:disabled {
             opacity: 0.6;
             cursor: not-allowed;
        }


        #game-title {
            color: #1a2a6c;
            /* Deep blue */
            margin-bottom: 15px;
            /* Less margin above counter */
            font-size: 2em;
            font-weight: 900;
        }

        .question-counter {
            font-size: 1em;
            color: #666;
            margin-bottom: 25px;
            /* Space below counter */
            font-weight: 400;
            /* Lato Regular */
        }

        #question-area {
            margin-bottom: 20px;
        }

        #question-text {
            font-size: 1.3em;
            margin-bottom: 20px;
            font-weight: 700;
            /* Lato Bold */
            line-height: 1.5;
            color: #444;
            text-align: left;
            /* Align question text left */
        }

        #answer-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
            /* Add margin below answer buttons */
        }

         #essay-self-correction-buttons {
             /* Container for essay correction buttons */
             margin-top: 15px; /* Space above buttons */
             margin-bottom: 20px; /* Space below buttons */
         }


        .answer-button {
            background-color: #f0f0f0;
            /* Light grey button */
            color: #333;
            border: 1px solid #ddd;
            padding: 12px 15px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            text-align: left;
            word-wrap: break-word;
            font-weight: 400;
        }

        .answer-button:hover:not(:disabled) {
            background-color: #e0e0e0;
            /* Slightly darker grey on hover */
            border-color: #ccc;
        }

        .answer-button:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* Visual feedback on answer buttons */
        .answer-button.correct {
            background-color: #4CAF50;
            /* Green */
            border-color: #4CAF50;
            color: white;
            font-weight: 700;
        }

        .answer-button.incorrect {
            background-color: #f44336;
            /* Red */
            border-color: #f44336;
            color: white;
            font-weight: 700;
        }

        #feedback {
            margin-top: 20px;
            font-size: 1.1em;
            min-height: 1.4em;
            font-weight: 700;
            color: #333;
            /* Neutral color, feedback color set by JS */
        }

        #explanation-area {
            margin-top: 15px;
            padding: 15px;
            background-color: #e8f5e9;
            /* Very light green for explanation */
            border: 1px solid #c8e6c9;
            /* Light green border */
            border-radius: 5px;
            text-align: left;
            color: #2e7d32;
            /* Dark green text */
            font-size: 0.95em;
            line-height: 1.5;
            opacity: 0;
            /* Start hidden */
            transform: translateY(10px);
            /* Start slightly lower */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            /* Animation */
        }

        #explanation-area.visible {
            /* Class added by JS */
            opacity: 1;
            transform: translateY(0);
        }


        #explanation-area h3 {
            margin-top: 0;
            margin-bottom: 8px;
            font-size: 1em;
            font-weight: 700;
            color: #1b5e20;
            /* Even darker green */
        }

        #score-area {
            margin-top: 20px;
            font-size: 1.1em;
            color: #1a2a6c;
            /* Deep blue */
            font-weight: 700;
        }

        .separator {
            border: none;
            border-top: 1px solid #eee;
            /* Very light solid line */
            height: 1px;
            margin: 20px 0;
        }

        #final-score {
            margin-top: 20px;
            font-size: 1.2em;
        }

        #final-score h2 {
            color: #1a2a6c;
            /* Deep blue */
            margin-bottom: 10px;
            font-weight: 900;
        }

        #final-score p {
            margin-bottom: 15px;
            font-weight: 700;
        }

        #final-score .action-button {
            margin-top: 15px;
            /* Less space above final score buttons */
        }


        #quote-area {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            /* Very light solid line */
            color: #6c757d;
            /* Muted grey text */
            font-size: 0.9em;
            font-style: italic;
            font-weight: 400;
        }

        #current-quote {
            margin: 0;
            line-height: 1.4;
        }

        .hidden {
            display: none;
        }
         /* Basic sub/sup styling for HTML within questions/answers/explanations */
         sub, sup {
             font-size: 0.7em;
             line-height: 0;
             position: relative;
             vertical-align: baseline;
         }
         sup { top: -0.5em; }
         sub { bottom: -0.2em; }
    </style>

    <!-- Link to Google Fonts (Lato) -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- jsPDF library for PDF generation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <div id="lesson-selection" class="container">
        <h2>Welcome<br>Choose a Lesson</h2>
        <!-- Lesson buttons will be added here by JavaScript -->
    </div>

    <div class="game-container container hidden">
        <h1 id="game-title">Math (Application) Game Show!</h1>
        <div class="question-counter">Question <span id="current-q-num">0</span> of <span id="total-q-num">0</span>
        </div>

        <div id="question-area">
            <p id="question-text">Loading question...</p>
            <div id="answer-buttons">
                <!-- MCQ Answer buttons will be added here by JavaScript -->
            </div>
            <button id="reveal-answer-button" class="action-button hidden">Reveal Answer</button> <!-- New Reveal button -->
            <div id="essay-self-correction-buttons" class="hidden">
                <!-- Essay self-correction buttons will be added here by JavaScript -->
            </div>
        </div>

        <div id="feedback">
            <!-- Feedback message (Correct/Incorrect/Skipped/Self-Corrected) will appear here -->
        </div>

        <div id="explanation-area" class="hidden">
            <h3>Explanation:</h3>
            <p id="explanation-text"></p>
        </div>

        <!-- Add the "Add to Remember" button here -->
        <button id="add-to-remember-button" class="action-button hidden">Add to Remember List</button>


        <div id="score-area">
            Score: <span id="score">0</span>
        </div>

        <hr class="separator">

        <!-- Add the Skip button (visible only for MCQs) -->
        <button id="skip-button" class="action-button hidden">Skip Question</button>

        <button id="next-button" class="action-button hidden">Next Question</button>

        <div id="final-score" class="hidden">
            <h2>Game Over!</h2>
            <p>Your final score for this lesson is: <span id="final-score-text">0</span> / <span
                    id="final-total-text">0</span></p>
            <button id="download-mistakes-pdf" class="action-button hidden">Download Review PDF</button>
            <!-- Add the "Export All" button here -->
            <button id="export-all-pdf-button" class="action-button hidden">Export All Questions with Answers</button>
            <button id="restart-button" class="action-button">Choose Another Lesson</button>
        </div>

        <div id="quote-area">
            <p id="current-quote"></p>
        </div>
    </div>

    <!-- Embedded JavaScript -->
    <script>
	// Define the lesson topic(s) based on the new PDF
	const Topics = {
    UNIT_7_TEST_1: 'Unit 7 Test (1)',
    UNIT_7_TEST_2: 'Unit 7 Test (2)',
    UNIT_8_TEST_1: 'Unit 8 Test (1)',
    UNIT_8_TEST_2: 'Unit 8 Test (2)',
    UNIT_9_TEST_1: 'Unit 9 Test (1)',
    UNIT_9_TEST_2: 'Unit 9 Test (2)',
    UNIT_10_TEST_1: 'Unit 10 Test (1)',
    UNIT_11_TEST_1: 'Unit 11 Test (1)',
    UNIT_12_TEST_1: 'Unit 12 Test (1)',
    TRANSLATION_A: 'Translation Section A',
    TRANSLATION_B: 'Translation Section B',
    THE_PLAY_ESSAYS: 'The Play: Essay Questions',
};

const allQuestions = [
    // Unit 7 Test (1) - Page 2
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 1,
        question: "Every student should have ..........to achieve their aims in life.",
        options: ["a)instruction", "b) determination", "c)error", "d)declaration"],
        correctAnswer: 1,
        correctAnswerText: "b) determination",
        explanation: "Determination refers to the firmness of purpose and resolve, which is crucial for achieving goals in life. Why this answer is correct: Determination is the drive to achieve goals. Why other options are incorrect: Instruction, error, and declaration do not fit the context of inner qualities needed for achieving aims.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 2,
        question: "A lot of people in the world .......for survival.",
        options: ["a)stop", "b)stand", "c)struggle", "d)steer"],
        correctAnswer: 2,
        correctAnswerText: "c)struggle",
        explanation: "To struggle means to make strenuous efforts to achieve or survive, which fits the context of people fighting for existence. Why this answer is correct: Struggle accurately describes the effort required for survival. Why other options are incorrect: Stop, stand, and steer do not convey the meaning of fighting for existence.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 3,
        question: "People should work hard to improve their standard of .........",
        options: ["a)life", "b)live", "c)alive", "d)living"],
        correctAnswer: 0,
        correctAnswerText: "a)life",
        explanation: "Standard of life (or standard of living) is a common phrase referring to the level of comfort, wealth, and quality of life. Why this answer is correct: Standard of life is the correct collocation. Why other options are incorrect: Live, alive, and living do not form the correct idiom in this context.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 4,
        question: "The writer has ........a lot of novels this year.",
        options: ["a)polished", "b)published", "c)disappeared", "d)gone out"],
        correctAnswer: 1,
        correctAnswerText: "b)published",
        explanation: "A writer publishes novels, meaning they make them available to the public. Why this answer is correct: Publishing is the action a writer takes to make novels available. Why other options are incorrect: Polished means refined; disappeared and gone out do not relate to writing.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 5,
        question: "......is the action of giving someone support, confidence or hope.",
        options: ["a)Confidence", "b)Disagreement", "c) Independence", "d) Encouragement"],
        correctAnswer: 3,
        correctAnswerText: "d) Encouragement",
        explanation: "The definition provided directly matches the meaning of encouragement. Why this answer is correct: Encouragement is the act of giving support, confidence, or hope. Why other options are incorrect: Confidence is a feeling, disagreement is opposition, and independence is self-reliance.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 6,
        question: "My neighbour is very kind. He usually ....old people up and takes them to places they want to go.",
        options: ["a)picks", "b)links", "c)kicks", "d)knocks"],
        correctAnswer: 0,
        correctAnswerText: "a)picks",
        explanation: "To pick someone up means to go to a place and collect someone in a vehicle. 'Picks up' fits the action of providing transport. Why this answer is correct: Pick up is the correct phrasal verb for collecting someone. Why other options are incorrect: Links, kicks, and knocks do not fit the context.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 7,
        question: "You have to ........the right of others.",
        options: ["a)restart", "b)restore", "c) respect", "d)replace"],
        correctAnswer: 2,
        correctAnswerText: "c) respect",
        explanation: "To respect the rights of others means to show regard for their entitlements and freedoms. Why this answer is correct: Respect is crucial for upholding the rights of others. Why other options are incorrect: Restart, restore, and replace do not fit the meaning.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 8,
        question: "A lot of Egyptians live abroad. The synonym of the word \"abroad \" is.......",
        options: ["a)presence", "b)inside", "c) overseas", "d)in land"],
        correctAnswer: 2,
        correctAnswerText: "c) overseas",
        explanation: "Abroad means in or to a foreign country. Overseas is a direct synonym, meaning in, from, or to a foreign country, especially one across the sea. Why this answer is correct: Overseas is a direct synonym for abroad. Why other options are incorrect: Presence, inside, and in land do not have the same meaning.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 9,
        question: "Samir ........his car at the moment.",
        options: ["a)mends", "b)is mending", "c)mends", "d)mending"],
        correctAnswer: 1,
        correctAnswerText: "b)is mending",
        explanation: "At the moment indicates a present continuous action. 'Is mending' (or 'is repairing') correctly uses the present continuous tense. Why this answer is correct: Is mending correctly expresses an ongoing action at the moment. Why other options are incorrect: Mends (simple present) implies a habitual action, and mending (gerund/participle) needs an auxiliary verb.<br><br><b>Reference:</b> Grammar: Present Continuous."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 10,
        question: "Nabil has booked a ticket. He .........to Cairo tomorrow.",
        options: ["a)will travel", "b)travel", "C)is travelling", "d)travelling"],
        correctAnswer: 2,
        correctAnswerText: "C)is travelling",
        explanation: "When talking about definite future arrangements (indicated by 'has booked a ticket' and 'tomorrow'), the present continuous tense is commonly used. Why this answer is correct: Is travelling is used for definite future plans. Why other options are incorrect: Will travel is for predictions or decisions made at the moment of speaking, travel is simple present, and travelling (gerund/participle) needs an auxiliary verb.<br><br><b>Reference:</b> Grammar: Present Continuous for Future."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 11,
        question: "Mother has prepared everything. She .........in the afternoon.",
        options: ["a)cooks", "b)cooking", "c)is cooking", "d)will cook"],
        correctAnswer: 2,
        correctAnswerText: "c)is cooking",
        explanation: "Has prepared everything implies that the preparation is complete, and the next logical step, occurring at a specific time 'in the afternoon', is the act of cooking. 'Is cooking' implies a planned action. Why this answer is correct: Is cooking indicates a planned or scheduled action. Why other options are incorrect: Cooks (simple present) for habitual action, cooking (gerund/participle) needs an auxiliary, and will cook for a spontaneous decision.<br><br><b>Reference:</b> Grammar: Present Continuous for Future."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 12,
        question: "You can't see Nabil now. He.......",
        options: ["a)is sleeping", "b)sleeps", "c)sleeping", "d)slept"],
        correctAnswer: 0,
        correctAnswerText: "a)is sleeping",
        explanation: "'Now' indicates a present continuous action. If you can't see him now, it's because he is sleeping. Why this answer is correct: Is sleeping correctly describes an ongoing action at the present moment. Why other options are incorrect: Sleeps is simple present, sleeping needs an auxiliary, and slept is past tense.<br><br><b>Reference:</b> Grammar: Present Continuous."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 13,
        question: "They have arranged to play tennis tomorrow. They........at 7 o'clock tomorrow.",
        options: ["a)are playing", "b)plays", "c)played", "d)is playing"],
        correctAnswer: 0,
        correctAnswerText: "a)are playing",
        explanation: "'Have arranged' indicates a firm future plan with a specific time. The present continuous 'are playing' is used for such pre-arranged future events. Why this answer is correct: Are playing is used for definite future arrangements. Why other options are incorrect: Plays is simple present, played is past tense, and is playing is singular.<br><br><b>Reference:</b> Grammar: Present Continuous for Future."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 14,
        question: "It is important to focus .........your strength.",
        options: ["a)out", "b)with", "c)on", "d)up"],
        correctAnswer: 2,
        correctAnswerText: "c)on",
        explanation: "The correct preposition to use with 'focus' when referring to what is being focused on is 'on'. Why this answer is correct: Focus on is the correct prepositional phrase. Why other options are incorrect: Out, with, and up do not form a correct phrase with focus in this context.<br><br><b>Reference:</b> Grammar: Prepositions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_1,
        originalNumber: 15,
        question: "My bag is similar ......yours but mine is smaller",
        options: ["a)up", "b)to", "c)as", "d)for"],
        correctAnswer: 1,
        correctAnswerText: "b)to",
        explanation: "The correct preposition used with 'similar' is 'to'. 'Similar to something.' Why this answer is correct: Similar to is the correct prepositional phrase. Why other options are incorrect: Up, as, and for do not form a correct phrase with similar.<br><br><b>Reference:</b> Grammar: Prepositions."
    },

    // Unit 7 Test (2) - Page 3
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 1,
        question: "Soha's parents always give her a lot of support and ..........",
        options: ["a) encouragement", "b)determination", "c)entertainment", "d)condensation"],
        correctAnswer: 0,
        correctAnswerText: "a) encouragement",
        explanation: "Support and encouragement is a common collocation referring to help and confidence-boosting. Why this answer is correct: Encouragement complements support. Why other options are incorrect: Determination, entertainment, and condensation do not fit the context.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 2,
        question: "There are no simple ........to the problem of overpopulation.",
        options: ["a)attention", "b)troubles", "c)alternatives", "d)expectations"],
        correctAnswer: 2,
        correctAnswerText: "c)alternatives",
        explanation: "Alternatives are other possible choices or solutions. The sentence means there are no easy solutions. Why this answer is correct: Alternatives refers to other solutions. Why other options are incorrect: Attention, troubles, and expectations do not fit the meaning of solutions.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 3,
        question: ".........is something that you do to punish somebody who has hurt you.",
        options: ["a) Revenge", "b) Prove", "c)Determination", "d)Madness"],
        correctAnswer: 0,
        correctAnswerText: "a) Revenge",
        explanation: "The definition directly matches the meaning of revenge. Why this answer is correct: Revenge is the act of punishing someone who has hurt you. Why other options are incorrect: Prove, determination, and madness do not fit the definition.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 4,
        question: "I can't find a taxi. Can you ........me up to school, please?",
        options: ["a)give", "b)get", "c) pick", "d)grow"],
        correctAnswer: 2,
        correctAnswerText: "c) pick",
        explanation: "To pick someone up means to collect them in a vehicle. Why this answer is correct: Pick up is the correct phrasal verb for collecting someone. Why other options are incorrect: Give, get, and grow do not fit the context of giving a ride.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 5,
        question: "A........is a vehicle with wheels that is pulled by horses.",
        options: ["a)car", "b)carriage", "c)plane", "d)court"],
        correctAnswer: 1,
        correctAnswerText: "b)carriage",
        explanation: "The definition describes a carriage, a horse-drawn vehicle. Why this answer is correct: A carriage is specifically a horse-drawn vehicle. Why other options are incorrect: Car, plane, and court are incorrect types of vehicles.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 6,
        question: "The educational authority presented strong .........for building a new school in the city.",
        options: ["a)disagreements", "b)articles", "c)titles", "d)arguments"],
        correctAnswer: 3,
        correctAnswerText: "d)arguments",
        explanation: "The educational authority would present arguments (reasons or sets of reasons) in favor of building a new school. Why this answer is correct: Arguments are reasons given to persuade. Why other options are incorrect: Disagreements, articles, and titles do not fit the context of presenting reasons for a proposal.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 7,
        question: "To.........is to go down on one or both knees.",
        options: ["a)leg", "b)kneel", "c)deceive", "d)receive"],
        correctAnswer: 1,
        correctAnswerText: "b)kneel",
        explanation: "The definition directly matches the verb kneel. Why this answer is correct: Kneel means to go down on one or both knees. Why other options are incorrect: Leg is a body part, deceive means to mislead, and receive means to get.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 8,
        question: "Nabil......his dinner now.",
        options: ["a)have", "b)has", "c)having", "d)is having"],
        correctAnswer: 3,
        correctAnswerText: "d)is having",
        explanation: "'Now' indicates a present continuous action. 'Is having' (meaning 'is eating') is the correct form. Why this answer is correct: Is having expresses an ongoing action (eating dinner) at the present moment. Why other options are incorrect: Have, has, and having are not used alone in the present continuous tense in this context.<br><br><b>Reference:</b> Grammar: Present Continuous."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 9,
        question: "Karam ..........his homework, so he can't go out for a walk.",
        options: ["a)do", "b)does", "c)is doing", "d)did"],
        correctAnswer: 2,
        correctAnswerText: "c)is doing",
        explanation: "'So he can't go out' implies an ongoing action preventing him. 'Is doing' (present continuous) indicates the homework is in progress. Why this answer is correct: Is doing accurately describes an ongoing action that prevents another. Why other options are incorrect: Do and does are simple present, and did is past tense.<br><br><b>Reference:</b> Grammar: Present Continuous."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 10,
        question: "Scarcely .........to the cinema.",
        options: ["a) had he been", "b)does he go", "c)is he going", "d)he goes"],
        correctAnswer: 1, // Changed from highlighted 'c'
        correctAnswerText: "b)does he go",
        explanation: "'Scarcely does he go' is the most common and grammatically correct way to express that someone rarely goes somewhere, using inversion after the negative adverb 'scarcely' for habitual actions. Why this answer is correct: Inversion with 'scarcely' for habitual actions uses 'does/do'. Why other options are incorrect: Had he been is past perfect, is he going is present continuous (doesn't fit habitual meaning), and he goes lacks inversion.<br><br><b>Reference:</b> Grammar: Inversion with Negative Adverbs."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 11,
        question: "Why........that fish! It smells terrible.",
        options: ["a)do you eat", "b)are you eating", "c)did you eat", "d)were you eating"],
        correctAnswer: 1,
        correctAnswerText: "b)are you eating",
        explanation: "The speaker notices the terrible smell 'now' and questions the ongoing action. The present continuous 'are you eating' is appropriate here. Why this answer is correct: Are you eating questions an ongoing action related to a present observation (the smell). Why other options are incorrect: Do you eat is for habitual action, did you eat is past simple, and were you eating is past continuous.<br><br><b>Reference:</b> Grammar: Present Continuous for Current Actions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_7_TEST_2,
        originalNumber: 12,
        question: "My friend ..........his birthday party at 7 o'clock tomorrow.",
        options: ["a)give", "b)gives", "c)gave", "d)is giving"],
        correctAnswer: 3,
        correctAnswerText: "d)is giving",
        explanation: "This indicates a definite future arrangement with a specific time. The present continuous 'is giving' is used for such plans. Why this answer is correct: Is giving indicates a definite future arrangement. Why other options are incorrect: Give and gives are simple present, and gave is past tense.<br><br><b>Reference:</b> Grammar: Present Continuous for Future."
    },

    // Unit 8 Test (1) - Page 4
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 13, // Continued from previous page's numbering
        question: "Listen! The teacher .........",
        options: ["a)speaks", "b) spoke", "c)speaking", "d)is speaking"],
        correctAnswer: 3,
        correctAnswerText: "d)is speaking",
        explanation: "'Listen!' indicates an immediate action happening now, hence the present continuous 'is speaking'. Why this answer is correct: Is speaking describes an action happening at the moment of speaking. Why other options are incorrect: Speaks is simple present, spoke is past tense, and speaking needs an auxiliary.<br><br><b>Reference:</b> Grammar: Present Continuous."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 14,
        question: "You have to depend .......yourself.",
        options: ["a)in", "b)on", "c)at", "d)for"],
        correctAnswer: 1,
        correctAnswerText: "b)on",
        explanation: "The correct preposition for 'depend' is 'on'. Why this answer is correct: Depend on is the correct phrasal verb. Why other options are incorrect: In, at, and for do not fit the meaning.<br><br><b>Reference:</b> Grammar: Prepositions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 15,
        question: "Don't worry .......me . I'll be all right.",
        options: ["a)in", "b)at", "c)about", "d)for"],
        correctAnswer: 2,
        correctAnswerText: "c)about",
        explanation: "The correct preposition to use with 'worry' in this context is 'about'. Why this answer is correct: Worry about is the correct phrasal verb. Why other options are incorrect: In, at, and for do not fit the meaning.<br><br><b>Reference:</b> Grammar: Prepositions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 1, // New numbering for Unit 8 vocabulary
        question: "..........is when something increases in size,range or amount.",
        options: ["a)Expansion", "b)Explanation", "c)Exploration", "d) Extension"],
        correctAnswer: 0,
        correctAnswerText: "a)Expansion",
        explanation: "The definition directly describes expansion, referring to an increase in size, scope, or volume. Why this answer is correct: Expansion means increasing in size or range. Why other options are incorrect: Explanation is clarification, exploration is discovery, and extension is an addition.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 2,
        question: "There are a lot of ........in my town.",
        options: ["a) facilities", "b)famines", "c)farms", "d)ferries"],
        correctAnswer: 0,
        correctAnswerText: "a) facilities",
        explanation: "Facilities refers to places, amenities, or services provided for a particular purpose in a town. Why this answer is correct: Facilities are amenities available in a town. Why other options are incorrect: Famines are severe food shortages, farms are agricultural land, and ferries are boats.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 3,
        question: "It is important to build up a ..........of professional contact among your colleagues.",
        options: ["a)contract", "b)collection", "c)chain", "d)network"],
        correctAnswer: 3,
        correctAnswerText: "d)network",
        explanation: "A network of professional contacts refers to a system of interconnected people, important for career development. Why this answer is correct: A network of contacts is the appropriate term. Why other options are incorrect: Contract is an agreement, collection is a group, and chain is a series.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 4,
        question: "What we need is a cheap and reliable ......... of public transportation to help all people in Egypt.",
        options: ["a)operation", "b)system", "c) procession", "d)process"],
        correctAnswer: 1,
        correctAnswerText: "b)system",
        explanation: "A system of public transportation refers to the organized network and methods of moving people. Why this answer is correct: A system is an organized set of methods or procedures. Why other options are incorrect: Operation is a procedure, procession is a line of people, and process is a series of actions.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 5,
        question: "The report ......a discussion of global warming.",
        options: ["a)consists", "b)includes", "c)encloses", "d)composes"],
        correctAnswer: 1,
        correctAnswerText: "b)includes",
        explanation: "A report includes a discussion, meaning it contains it as part of its content. Why this answer is correct: Includes means contains as part of a whole. Why other options are incorrect: Consists (of) means made up of, encloses means surrounds, and composes means creates.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 6,
        question: "To........is to join something to the main supply of electricity,gas or water to a telephone or computer network.",
        options: ["a) contack", "b)communicate", "c)connect", "d)contrast"],
        correctAnswer: 2,
        correctAnswerText: "c)connect",
        explanation: "The definition perfectly describes the action of connecting. Why this answer is correct: Connect means to link or join. Why other options are incorrect: Contack is a misspelling, communicate is to share information, and contrast is to show differences.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 7,
        question: "Could you .......the lesson again,please?",
        options: ["a)say", "b)beg", "c)complain", "d)explain"],
        correctAnswer: 3,
        correctAnswerText: "d)explain",
        explanation: "To explain a lesson means to make it clear and understandable. Why this answer is correct: Explain means to make something clear. Why other options are incorrect: Say is to speak, beg is to ask earnestly, and complain is to express dissatisfaction.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 8,
        question: "The criminal didn't have .........explanation for committing the crime.",
        options: ["a)stress", "b)satisfaction", "c)satisfactory", "d)stressful"],
        correctAnswer: 2,
        correctAnswerText: "c)satisfactory",
        explanation: "A satisfactory explanation is one that is adequate, reasonable, or convincing. Why this answer is correct: Satisfactory means acceptable or adequate. Why other options are incorrect: Stress and satisfaction are nouns, stressful is an adjective describing something causing stress.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 9,
        question: "By next August, the government.......... the new bridge.",
        options: ["a)will finish", "b)will have finished", "c) will have been finished", "d)finishes"],
        correctAnswer: 1,
        correctAnswerText: "b)will have finished",
        explanation: "'By next August' indicates a future perfect tense. The action (finishing the bridge) will be completed by a specific time in the future. Why this answer is correct: Will have finished is the future perfect, indicating completion by a future point. Why other options are incorrect: Will finish is simple future, will have been finished is passive future perfect, and finishes is simple present.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 10,
        question: "Will They ........a new school by next year?",
        options: ["A)build", "b)built", "c) have built", "d)building"],
        correctAnswer: 2,
        correctAnswerText: "c) have built",
        explanation: "'By next year' signals the future perfect tense. The question asks if they will have completed building the school by that time. 'Will they have built' is the correct structure. Why this answer is correct: Have built completes the future perfect question. Why other options are incorrect: Build and built are incomplete, and building is a noun or participle.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_1,
        originalNumber: 11,
        question: "In two hours time, I .........all my homework.",
        options: ["a) Will do", "b) will have done", "c)are doing", "d)will be doing"],
        correctAnswer: 1,
        correctAnswerText: "b) will have done",
        explanation: "'In two hours time' means by the end of two hours. This is a point in the future by which an action will be completed, thus requiring the future perfect tense. Why this answer is correct: Will have done is the future perfect, indicating completion by a future time. Why other options are incorrect: Will do is simple future, are doing is present continuous, and will be doing is future continuous.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },

    // Unit 8 Test (2) - Page 5
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 12, // Continued numbering from Unit 8 Test 1
        question: "They plan to play football next week. They .......it at 9 o'clock.",
        options: ["a)will play", "b)going to play", "c)are going to play", "d)plays"],
        correctAnswer: 2,
        correctAnswerText: "c)are going to play",
        explanation: "'They plan to' indicates intention, and 'at 9 o'clock' gives a specific time. 'Are going to play' is suitable for planned future actions. Why this answer is correct: Are going to play expresses a definite plan or intention. Why other options are incorrect: Will play is simple future, going to play needs an auxiliary, and plays is simple present.<br><br><b>Reference:</b> Grammar: Be Going To for Future."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 13,
        question: "This time next week. I .......physics.",
        options: ["a)will finish", "b) will have finished", "c)will being finish", "d)finishes"],
        correctAnswer: 1,
        correctAnswerText: "b) will have finished",
        explanation: "'This time next week' indicates a point in the future by which an action will be completed. This requires the future perfect tense. Why this answer is correct: Will have finished is the future perfect, indicating completion by a future point. Why other options are incorrect: Will finish is simple future, will being finish is grammatically incorrect, and finishes is simple present.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 14,
        question: "Nabil always comes .........",
        options: ["a- lately", "b- late", "c- later than", "d- latest"],
        correctAnswer: 1,
        correctAnswerText: "b- late",
        explanation: "'Late' is an adverb describing how Nabil comes. 'Lately' means recently; 'later than' requires a comparison; 'latest' means most recent. Why this answer is correct: Late functions as an adverb here, describing the manner of coming. Why other options are incorrect: Lately means recently, later than is a comparison, and latest is a superlative adjective.<br><br><b>Reference:</b> Grammar: Adverbs."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 15,
        question: "By next November,all the leaves .........",
        options: ["a)may be fallen", "b)will have filled", "c)will have felled", "d)will have fallen"],
        correctAnswer: 3,
        correctAnswerText: "d)will have fallen",
        explanation: "'By next November' indicates a future perfect tense. The action of leaves falling will be completed by that time. Why this answer is correct: Will have fallen is the future perfect, indicating completion by a future point. Why other options are incorrect: May be fallen is passive and implies possibility, will have filled means to make full, and will have felled means to cut down a tree.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 1, // New numbering for Unit 8 Test 2 vocabulary
        question: "We should all ........each other to live peacefully.",
        options: ["a)aspect", "b)restart", "c) respect", "d)reclaim"],
        correctAnswer: 2,
        correctAnswerText: "c) respect",
        explanation: "To respect each other is fundamental for peaceful coexistence. Why this answer is correct: Respect is essential for peaceful living. Why other options are incorrect: Aspect is a part, restart means to begin again, and reclaim means to get back.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 2,
        question: "All Egyptians are.........to serve their country.",
        options: ["a)voluntary", "b)volunteer", "c)volunteers", "d)greedy"],
        correctAnswer: 0, // Changed from highlighted 'c'
        correctAnswerText: "a)voluntary",
        explanation: "'Voluntary' is an adjective meaning done or given willingly. 'All Egyptians are voluntary to serve their country' implies they serve willingly. 'Volunteers' is a noun and doesn't fit the grammatical structure here. Why this answer is correct: Voluntary is an adjective that describes the willingness to serve. Why other options are incorrect: Volunteer is a verb, volunteers is a noun (plural), and greedy means having an excessive desire.<br><br><b>Reference:</b> Grammar: Adjectives."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 3,
        question: "All people in the world should be co-operative to solve ........among countries.",
        options: ["a)tissues", "b)issues", "c)debate", "d)agreement"],
        correctAnswer: 1,
        correctAnswerText: "b)issues",
        explanation: "Issues refers to important topics or problems for debate or discussion. Co-operation is needed to solve global issues. Why this answer is correct: Issues are problems that need cooperation to solve. Why other options are incorrect: Tissues are biological structures, debate is discussion, and agreement is a consensus.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 4,
        question: "We should encourage public............to solve the problem of pollution.",
        options: ["a)translate", "b)transfer", "c)transport", "d)treatment"],
        correctAnswer: 2,
        correctAnswerText: "c)transport",
        explanation: "Encouraging public transport can help solve pollution problems by reducing private car use. Why this answer is correct: Public transport reduces pollution. Why other options are incorrect: Translate is to convert language, transfer is to move, and treatment is medical care.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 5,
        question: "There is no .........that necessity is the mother of invention.",
        options: ["a)debt", "b)doubt", "c)deal", "d)dream"],
        correctAnswer: 1,
        correctAnswerText: "b)doubt",
        explanation: "'There is no doubt' is a common idiom meaning it is certain. Why this answer is correct: There is no doubt is a common idiom for certainty. Why other options are incorrect: Debt is money owed, deal is an agreement, and dream is an aspiration.<br><br><b>Reference:</b> Idioms/Collocations."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 6,
        question: "The airport was jammed with thousands of ..........from delayed or cancelled flights.",
        options: ["a)presenters", "b)interviewers", "c)passengers", "d)drivers"],
        correctAnswer: 2,
        correctAnswerText: "c)passengers",
        explanation: "Airports are typically jammed with passengers when flights are delayed or cancelled. Why this answer is correct: Passengers are people who travel on a public transport. Why other options are incorrect: Presenters give speeches, interviewers ask questions, and drivers operate vehicles.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 7,
        question: "You should check all your electrical ............regularly.",
        options: ["a) equipment", "b)process", "c)advice", "d)manual"],
        correctAnswer: 0,
        correctAnswerText: "a) equipment",
        explanation: "Electrical equipment refers to devices that run on electricity. It's important to check it regularly for safety. Why this answer is correct: Equipment refers to necessary items for a particular purpose. Why other options are incorrect: Process is a series of actions, advice is guidance, and manual is a handbook.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 8,
        question: "The ...........cost was far higher than we had expected.",
        options: ["a)plural", "b)singular", "c)title", "d)total"],
        correctAnswer: 3,
        correctAnswerText: "d)total",
        explanation: "The 'total cost' refers to the entire sum of money spent. Why this answer is correct: Total cost refers to the overall sum. Why other options are incorrect: Plural and singular relate to number, and title is a name.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 9,
        question: "My brother .........17 next year.",
        options: ["a)will be", "b)is going to be", "c)has been", "d)was"],
        correctAnswer: 0,
        correctAnswerText: "a)will be",
        explanation: "This is a simple future statement about age. Why this answer is correct: Will be is the simple future tense. Why other options are incorrect: Is going to be also expresses future, but will be is more direct for a factual future event like age. Has been is present perfect, and was is past tense.<br><br><b>Reference:</b> Grammar: Simple Future."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 10,
        question: "In the year 2030 Egypt ........the new cities",
        options: ["a)will build", "b)will be building", "c)will have built", "d)builds"],
        correctAnswer: 2,
        correctAnswerText: "c)will have built",
        explanation: "'In the year 2030' indicates a future point in time by which the action (building cities) will be completed. This requires the future perfect tense. Why this answer is correct: Will have built is the future perfect, indicating completion by a future point. Why other options are incorrect: Will build is simple future, will be building is future continuous, and builds is simple present.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_8_TEST_2,
        originalNumber: 11,
        question: "By 2025 two great projects ...........in Egypt.",
        options: ["a)will do", "b)will have done", "c)will be doing", "d)will have been done"],
        correctAnswer: 3,
        correctAnswerText: "d)will have been done",
        explanation: "'By 2025' indicates a future perfect tense. The projects will be completed by that time. 'Will have been done' is the passive voice of the future perfect, appropriate for 'projects'. Why this answer is correct: Will have been done is the passive future perfect for actions completed by a future time. Why other options are incorrect: Will do and will have done are active voice, will be doing is future continuous.<br><br><b>Reference:</b> Grammar: Future Perfect Passive."
    },

    // Unit 9 Test (1) - Page 6
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 12, // Continued numbering from Unit 8 Test 2, original PDF shows it in this section
        question: "He has arranged to spend his holiday in Aswan. He ........next week.",
        options: ["a)will travel", "b)travels", "c)is travelling", "d)has travel"],
        correctAnswer: 2,
        correctAnswerText: "c)is travelling",
        explanation: "'Has arranged' indicates a definite future plan, for which the present continuous 'is travelling' is commonly used. Why this answer is correct: Is travelling is used for definite future arrangements. Why other options are incorrect: Will travel is less specific, travels is simple present, and has travel is grammatically incorrect.<br><br><b>Reference:</b> Grammar: Present Continuous for Future."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 13,
        question: "The plane ........at Cairo airport at 10 O'clock.",
        options: ["a)arrive", "b)arrives", "c)will arrive", "d)arrived"],
        correctAnswer: 1,
        correctAnswerText: "b)arrives",
        explanation: "For scheduled events like plane arrivals (timetables), the simple present tense is used, even when referring to the future. Why this answer is correct: Arrives is used for scheduled events. Why other options are incorrect: Arrive is base form, will arrive is simple future (less common for timetables), and arrived is past tense.<br><br><b>Reference:</b> Grammar: Simple Present for Future Schedules."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 14,
        question: "The painters ........the hall by tomorrow night.",
        options: ["a)be painting", "b)have painting", "c) will have painted", "d)paint"],
        correctAnswer: 2,
        correctAnswerText: "c) will have painted",
        explanation: "'By tomorrow night' indicates a future perfect tense. The action of painting will be completed by that time. Why this answer is correct: Will have painted is the future perfect, indicating completion by a future point. Why other options are incorrect: Be painting is future continuous, have painting is grammatically incorrect, and paint is simple present.<br><br><b>Reference:</b> Grammar: Future Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 15,
        question: "The plural of the word \"belief\"",
        options: ["a)believes", "b)belief", "c) beliefs", "d)believe"],
        correctAnswer: 2,
        correctAnswerText: "c) beliefs",
        explanation: "The plural form of \"belief\" is 'beliefs'. Why this answer is correct: Beliefs is the correct plural form. Why other options are incorrect: Believes is a verb, belief is singular, and believe is a verb.<br><br><b>Reference:</b> Vocabulary: Plural Forms."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 1, // New numbering for Unit 9 Test 1
        question: "The .........of the computer is that it saves time and effort.",
        options: ["a)cons", "b)pros", "c) prose", "d)coins"],
        correctAnswer: 1,
        correctAnswerText: "b)pros",
        explanation: "'Pros' is short for 'advantages' or 'positive points', which fits the benefit described. Why this answer is correct: Pros refers to advantages. Why other options are incorrect: Cons refers to disadvantages, prose is written language, and coins are money.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 2,
        question: "The government should make laws to protect ......animals all over the country.",
        options: ["a)danger", "b)endangered", "c)secure", "d)serious"],
        correctAnswer: 1,
        correctAnswerText: "b)endangered",
        explanation: "Endangered animals are those at risk of extinction and often require protection laws. Why this answer is correct: Endangered animals are those at risk of extinction. Why other options are incorrect: Danger is a threat, secure means safe, and serious means significant.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 3,
        question: "I have ..........a table at the restaurant for ten o'clock.",
        options: ["a)took", "b)booked", "c)place", "d)leaked"],
        correctAnswer: 1,
        correctAnswerText: "b)booked",
        explanation: "To book a table means to reserve it in advance. Why this answer is correct: Booked means reserved in advance. Why other options are incorrect: Took means carried, place is a location, and leaked means allowed liquid to escape.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 4,
        question: "My grandmother often puts fruit in jars with lots of sugar to.....them.",
        options: ["a)reserve", "b)preserve", "c)prevent", "d)serve"],
        correctAnswer: 1,
        correctAnswerText: "b)preserve",
        explanation: "To preserve fruit means to prepare it (e.g., with sugar) to keep it from decaying. Why this answer is correct: Preserve means to maintain in its original state. Why other options are incorrect: Reserve means to keep for future use, prevent means to stop from happening, and serve means to present.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 5,
        question: "Judy hopes to get a...........so that she can study at a really good university.",
        options: ["a)scholarship", "b)money", "c)help", "d)price"],
        correctAnswer: 0,
        correctAnswerText: "a)scholarship",
        explanation: "A scholarship is a grant or payment to support a student's education. Why this answer is correct: A scholarship provides financial aid for education. Why other options are incorrect: Money is general currency, help is assistance, and price is the cost of something.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 6,
        question: "Planning a wedding reception for over 1000 guests will be very .........",
        options: ["a)challenged", "b)challenging", "c)changed", "d)unchangeable"],
        correctAnswer: 1,
        correctAnswerText: "b)challenging",
        explanation: "A challenging task is one that is difficult but stimulating and interesting, fitting for a large event. Why this answer is correct: Challenging means difficult but stimulating. Why other options are incorrect: Challenged is past participle of verb, changed is past participle of verb, and unchangeable means unable to be changed.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 7,
        question: "My cousin is very ............she can sing and speak four languages.",
        options: ["a)historical", "b)hostile", "c)powerful", "d)talented"],
        correctAnswer: 3,
        correctAnswerText: "d)talented",
        explanation: "Someone who can sing well and speak multiple languages is talented. Why this answer is correct: Talented means having a natural aptitude or skill. Why other options are incorrect: Historical relates to history, hostile means unfriendly, and powerful means having great strength.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 8,
        question: "How about a .........to the zoo next week? I feel bored.",
        options: ["a)trip", "b)trap", "c)voyage", "d)tape"],
        correctAnswer: 0,
        correctAnswerText: "a)trip",
        explanation: "A 'trip to the zoo' is a common phrase for a short journey or excursion. Why this answer is correct: Trip is a short journey. Why other options are incorrect: Trap is a device for catching animals, voyage is a long journey by sea, and tape is a strip of material.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 9,
        question: "Omar ...... ........games every day. He no longer does that.",
        options: ["a)is used to playing", "b)is used for playing", "c) used to play", "d)played"],
        correctAnswer: 2,
        correctAnswerText: "c) used to play",
        explanation: "'Used to play' expresses a past habit that no longer occurs, which is consistent with 'He no longer does that.' Why this answer is correct: Used to + infinitive expresses past habits. Why other options are incorrect: Is used to playing means accustomed to, is used for playing means purpose, and played is simple past.<br><br><b>Reference:</b> Grammar: Used To."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_1,
        originalNumber: 10,
        question: "He ........spend all his free time writing. he no longer does that.",
        options: ["a)is used to", "b)uses", "c)used to", "d) was using"],
        correctAnswer: 2,
        correctAnswerText: "c)used to",
        explanation: "'Used to spend' expresses a past habit that no longer occurs, similar to the previous question. Why this answer is correct: Used to + infinitive expresses past habits. Why other options are incorrect: Is used to means accustomed to, uses is present simple, and was using is past continuous.<br><br><b>Reference:</b> Grammar: Used To."
    },

    // Unit 9 Test (2) - Page 7
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 11, // Continued numbering from Unit 9 Test 1
        question: "A calculator ...........do sums.",
        options: ["a) is used to", "b)is used for", "c)used to", "d)used for"],
        correctAnswer: 0,
        correctAnswerText: "a) is used to",
        explanation: "'Is used to' + bare infinitive describes the purpose or function of an object. Why this answer is correct: Is used to + infinitive describes purpose. Why other options are incorrect: Is used for + gerund describes purpose, used to + infinitive describes past habit, used for is incomplete.<br><br><b>Reference:</b> Grammar: Used To / Be Used To."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 12,
        question: "Your car is exactly the same ......my car.",
        options: ["a)for", "b)in", "c)as", "d)from"],
        correctAnswer: 2,
        correctAnswerText: "c)as",
        explanation: "The correct comparative structure for exact similarity is 'the same as'. Why this answer is correct: The same as is the correct comparative structure. Why other options are incorrect: For, in, and from are incorrect prepositions.<br><br><b>Reference:</b> Grammar: Comparisons."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 13,
        question: "In Cairo people ........noise every day.",
        options: ["a)use to", "b)are used", "c)are used to", "d)used to"],
        correctAnswer: 2,
        correctAnswerText: "c)are used to",
        explanation: "'Are used to' + noun/gerund expresses familiarity or habituation to something. People in Cairo are accustomed to noise. Why this answer is correct: Are used to + noun describes being accustomed to something. Why other options are incorrect: Use to is for past habits, are used needs a completion, and used to is for past habits.<br><br><b>Reference:</b> Grammar: Be Used To."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 14,
        question: "Did Ali ............to swim in the sea when he was in Alexandria?",
        options: ["a)use", "b)used", "c)using", "d)is used to"],
        correctAnswer: 0,
        correctAnswerText: "a)use",
        explanation: "In questions with 'Did', the base form 'use' is used for 'used to' (e.g., 'Did you use to...?'). Why this answer is correct: Did requires the base form 'use' for 'used to'. Why other options are incorrect: Used is incorrect with Did, using is a participle, and is used to means accustomed to.<br><br><b>Reference:</b> Grammar: Used To (Interrogative)."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 15,
        question: "Your suit is .........cheaper than my suit.",
        options: ["a)slight", "b)slightly", "c)sight", "d)night"],
        correctAnswer: 1,
        correctAnswerText: "b)slightly",
        explanation: "'Slightly' is an adverb that modifies 'cheaper' (a comparative adjective), indicating a small difference. Why this answer is correct: Slightly is an adverb modifying the adjective 'cheaper'. Why other options are incorrect: Slight is an adjective, sight is a noun, and night is a noun.<br><br><b>Reference:</b> Grammar: Adverbs of Degree."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 16,
        question: "He ..........in Cairo since he was born. He is still there.",
        options: ["a)has been", "b)has gone", "c) went", "d) had been"],
        correctAnswer: 0, // Changed from highlighted 'b'
        correctAnswerText: "a)has been",
        explanation: "'Has been' with 'since' indicates that someone has been in a place continuously from a past point up to the present. 'He is still there' confirms the continuous presence. 'Has gone' implies that he went there and is currently there, but 'has been' is more natural for continuous residence over a long period. Why this answer is correct: Has been is used for continuous presence from a past point up to now. Why other options are incorrect: Has gone means he went and is now there, but implies a recent arrival or going there; went is simple past; had been is past perfect.<br><br><b>Reference:</b> Grammar: Present Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 1, // New numbering for Unit 9 Test 2 vocabulary
        question: "The men made .......to Spain, Greece and Asia to find fossils.",
        options: ["a)duties", "b)tasks", "c) expedition", "d)picnics"],
        correctAnswer: 2,
        correctAnswerText: "c) expedition",
        explanation: "An expedition is an organized journey for a particular purpose, especially to explore a remote area, which fits finding fossils. Why this answer is correct: Expedition means a journey for a specific purpose. Why other options are incorrect: Duties are responsibilities, tasks are jobs, and picnics are outdoor meals.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 2,
        question: "There is a .........of pictures on the wall.",
        options: ["a)clarity", "b)various", "c) variety", "d)popularity"],
        correctAnswer: 2,
        correctAnswerText: "c) variety",
        explanation: "A variety of pictures means a diverse range of them. Why this answer is correct: Variety means a diverse range. Why other options are incorrect: Clarity is clearness, various is an adjective, and popularity is being liked.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 3,
        question: "A lot of ..........of animals and plants are about to become extinct.",
        options: ["a)spicy", "b)species", "c)spice", "d)space"],
        correctAnswer: 1,
        correctAnswerText: "b)species",
        explanation: "Species refers to a group of living organisms. Many species are endangered. Why this answer is correct: Species refers to biological classifications. Why other options are incorrect: Spicy describes food, spice is a seasoning, and space is an area.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 4,
        question: ".........is the existence of a large number of different kinds of animals and plants which make a balanced environment.",
        options: ["a)Biology", "b)Biochemistry", "c) Biodiversity", "d) Biodynamic"],
        correctAnswer: 2,
        correctAnswerText: "c) Biodiversity",
        explanation: "The definition accurately describes biodiversity. Why this answer is correct: Biodiversity refers to the variety of life in an ecosystem. Why other options are incorrect: Biology is the study of life, biochemistry is the chemistry of life, and biodynamic refers to a method of farming.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 5,
        question: "The new hotel has lots of modern .........including a gym and swimming pool.",
        options: ["a) facilities", "b)species", "c)objects", "d)innovators"],
        correctAnswer: 0,
        correctAnswerText: "a) facilities",
        explanation: "Facilities refers to amenities or services provided in a place. Why this answer is correct: Facilities are amenities or services. Why other options are incorrect: Species are biological, objects are things, and innovators are people who create new things.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 6,
        question: "Salma hopes to get a ..........so that she can study at a really good university.",
        options: ["a) scholarship", "b)money", "c)help", "d)price"],
        correctAnswer: 0,
        correctAnswerText: "a) scholarship",
        explanation: "A scholarship provides financial aid for education. Why this answer is correct: A scholarship provides financial support for education. Why other options are incorrect: Money is general, help is general assistance, and price is cost.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_9_TEST_2,
        originalNumber: 7,
        question: "...........is difficult in a way that tests your ability or determination.",
        options: ["a) Challenging", "b)Fighting", "c)Daring", "d)Encouraging"],
        correctAnswer: 0,
        correctAnswerText: "a) Challenging",
        explanation: "The definition perfectly describes something challenging. Why this answer is correct: Challenging means difficult but rewarding. Why other options are incorrect: Fighting is combat, daring is courageous, and encouraging is supportive.<br><br><b>Reference:</b> General vocabulary/context."
    },

    // Unit 10 Test (1) - Page 8
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 8, // Continued numbering from Unit 9 Test 2
        question: ".........is when a person, an animal, etc. continues to live.",
        options: ["a)Arrival", "b)Survival", "c)Sustain", "d) Suspect"],
        correctAnswer: 1,
        correctAnswerText: "b)Survival",
        explanation: "Survival is the state or fact of continuing to live or exist. Why this answer is correct: Survival is the act of continuing to live. Why other options are incorrect: Arrival is coming, sustain is to maintain, and suspect is to believe.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 9,
        question: "When he was young, he usually .........in the street.",
        options: ["a)play", "b)plays", "c)played", "d)playing"],
        correctAnswer: 2,
        correctAnswerText: "c)played",
        explanation: "The simple past tense 'played' is used to describe a habitual action in the past. Why this answer is correct: Played is the simple past for a past habit. Why other options are incorrect: Play and plays are present, and playing needs an auxiliary.<br><br><b>Reference:</b> Grammar: Simple Past for Habitual Actions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 10,
        question: "Did he .......to play in dust when he was young?",
        options: ["a)use", "b)used", "c)using", "d)uses"],
        correctAnswer: 0,
        correctAnswerText: "a)use",
        explanation: "In questions with 'Did', the base form 'use' is used for 'used to'. Why this answer is correct: Did requires the base form 'use' for 'used to'. Why other options are incorrect: Used is incorrect with Did, using is a participle, and uses is present simple.<br><br><b>Reference:</b> Grammar: Used To (Interrogative)."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 11,
        question: "Nabil used to eat chips. Now, he...........",
        options: ["a)isn't", "b)doesn't", "c) don't", "d)didn't"],
        correctAnswer: 1,
        correctAnswerText: "b)doesn't",
        explanation: "'Used to' implies a past habit that no longer happens. To negate it in the present, 'Now, he doesn't' is correct. Why this answer is correct: Doesn't is the correct present simple negation for a singular subject. Why other options are incorrect: Isn't is for 'be' verb, don't is for plural subjects, and didn't is past.<br><br><b>Reference:</b> Grammar: Negation of Past Habits."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 12,
        question: "Noha used to be fat. Now, she is ..........",
        options: ["a)sad", "b)big", "c)thin", "d)sin"],
        correctAnswer: 2,
        correctAnswerText: "c)thin",
        explanation: "If she 'used to be fat' and 'now' is the opposite, she is thin. Why this answer is correct: Thin is the opposite of fat. Why other options are incorrect: Sad is an emotion, big is large, and sin is a wrongdoing.<br><br><b>Reference:</b> Vocabulary: Opposites."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 13,
        question: "A camera is used to ........photographs.",
        options: ["a) take", "b)takes", "c) taking", "d)took"],
        correctAnswer: 2,
        correctAnswerText: "c) taking",
        explanation: "'Is used to' + gerund (taking) describes the purpose of the object. Why this answer is correct: Is used to + gerund describes purpose. Why other options are incorrect: Take and takes are bare verbs, and took is past tense.<br><br><b>Reference:</b> Grammar: Be Used To + Gerund."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 14,
        question: "Moustafa hates exams. He ...........worry before exams.",
        options: ["a)uses to", "b)used to", "c)used", "d)is used to"],
        correctAnswer: 1, // Sticking to highlighted 'b' despite contextual ambiguity
        correctAnswerText: "b)used to",
        explanation: "The phrase 'used to worry' describes a past habitual action. While the phrase 'hates exams' implies a current negative feeling that might suggest ongoing worry, 'used to' specifically refers to a habit in the past that may or may not continue. Grammatically, 'used to' followed by an infinitive (worry) is correct for expressing past habits. Why this answer is correct: 'Used to' correctly expresses a past habit. Why other options are incorrect: 'Uses to' is grammatically incorrect, 'used' is incomplete, and 'is used to' requires a gerund ('worrying') for being accustomed to something.<br><br><b>Reference:</b> Grammar: Used To."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 15,
        question: "Ramy used to be an actor. Now, he ..........",
        options: ["a)don't", "b)doesn't", "c) isn't", "d)arent"],
        correctAnswer: 2,
        correctAnswerText: "c) isn't",
        explanation: "'Used to be' implies a past state that is no longer true. So, 'Now, he isn't (an actor).' Why this answer is correct: Isn't negates the past state 'used to be'. Why other options are incorrect: Don't/doesn't negates actions, and aren't is for plural subjects.<br><br><b>Reference:</b> Grammar: Negation of Past States."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 16,
        question: "He used to eat a lot. Now, he no longer .......a lot.",
        options: ["a)eat", "b)ate", "c)eats", "d)eating"],
        correctAnswer: 2, // Changed from highlighted 'd'
        correctAnswerText: "c)eats",
        explanation: "'No longer' requires a simple present verb for the current situation. 'He no longer eats a lot.' Why this answer is correct: Eats is the correct simple present verb for a singular subject with 'no longer'. Why other options are incorrect: Eat is base form, ate is past tense, and eating needs an auxiliary.<br><br><b>Reference:</b> Grammar: No Longer."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 1, // New numbering for Unit 10 Test 1
        question: "Saudia Arabia is Egypt's principal trading ..........in the Arab world.",
        options: ["a)colleague", "b)consumer", "c)partner", "d)competitor"],
        correctAnswer: 2,
        correctAnswerText: "c)partner",
        explanation: "A 'trading partner' is a country that engages in trade with another. Why this answer is correct: Partner refers to an entity with whom one trades. Why other options are incorrect: Colleague is a co-worker, consumer is a buyer, and competitor is a rival.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 2,
        question: "I have an artistic eye and would like to be a ......when I am older.",
        options: ["a)newsreader", "b)volunteer", "c) nurse", "d)photographer"],
        correctAnswer: 3,
        correctAnswerText: "d)photographer",
        explanation: "Someone with an 'artistic eye' would likely pursue a creative profession like a photographer. Why this answer is correct: An artistic eye is suited for photography. Why other options are incorrect: Newsreader, volunteer, and nurse do not directly relate to an artistic eye.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 3,
        question: "My uncle is a/an ........He collects and tells the news for newspapers.",
        options: ["a)reporter", "b)newsreader", "c)farmer", "d)electrician"],
        correctAnswer: 0,
        correctAnswerText: "a)reporter",
        explanation: "A reporter collects and tells the news for newspapers. Why this answer is correct: A reporter gathers and conveys news. Why other options are incorrect: Newsreader reads news aloud, farmer works land, and electrician works with electricity.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 4,
        question: "Could we postpone the meeting until a more .......time?",
        options: ["a)in expensive", "b)convenient", "c)valueless", "d)economic"],
        correctAnswer: 1,
        correctAnswerText: "b)convenient",
        explanation: "A 'convenient time' is one that suits everyone's schedules. Why this answer is correct: Convenient means suitable or easy to arrange. Why other options are incorrect: Inexpensive means cheap, valueless means worthless, and economic relates to economy.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 5,
        question: "To..........means to hit, kick or fire guns at other people",
        options: ["a)compete", "b)escape", "c)fight", "d)scare"],
        correctAnswer: 2,
        correctAnswerText: "c)fight",
        explanation: "The definition accurately describes to fight. Why this answer is correct: Fight means to engage in a struggle. Why other options are incorrect: Compete is to strive against rivals, escape is to get away, and scare is to frighten.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 6,
        question: ".........is the use of science to create devices for everyday use.",
        options: ["a)Technology", "b)Biography", "c)Photography", "d)Biology"],
        correctAnswer: 0,
        correctAnswerText: "a)Technology",
        explanation: "The definition accurately describes technology. Why this answer is correct: Technology is the application of scientific knowledge. Why other options are incorrect: Biography is a life story, photography is taking pictures, and biology is the study of living organisms.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_10_TEST_1,
        originalNumber: 7,
        question: "Ambulances drive very fast where there is an .........",
        options: ["a)Imagination", "b)emergency", "c)emigration", "d)station"],
        correctAnswer: 1,
        correctAnswerText: "b)emergency",
        explanation: "Ambulances drive fast in an emergency, which is a serious situation requiring immediate action. Why this answer is correct: Emergency is a serious situation requiring urgent action. Why other options are incorrect: Imagination is creativity, emigration is leaving a country, and station is a building.<br><br><b>Reference:</b> General vocabulary/context."
    },

    // Unit 11 Test (1) - Page 9
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 8, // Continued numbering from Unit 10 Test 1
        question: "When he retires, he will be able to look back over brilliant .....",
        options: ["a)mission", "b)routine", "c)task", "d)career"],
        correctAnswer: 3,
        correctAnswerText: "d)career",
        explanation: "A 'brilliant career' refers to a successful professional life. Why this answer is correct: Career refers to a person's professional life. Why other options are incorrect: Mission is a task, routine is a regular procedure, and task is a piece of work.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 9,
        question: "After the tree.....down, they took it away from the street.",
        options: ["a)had cut", "b)had been cut", "c)had felled", "d)has been fallen"],
        correctAnswer: 1,
        correctAnswerText: "b)had been cut",
        explanation: "The sequence of events (first cut, then taken away) suggests the past perfect. 'Had been cut' is passive voice, suitable for 'the tree' (it was cut by someone). Why this answer is correct: Had been cut is past perfect passive, indicating the action happened before another past action. Why other options are incorrect: Had cut is active, had felled is active (meaning 'cut down'), and has been fallen is grammatically incorrect.<br><br><b>Reference:</b> Grammar: Past Perfect Passive."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 10,
        question: "She washed the dishes before that she .......food.",
        options: ["a) cooks", "b)cooked", "c)had cooked", "d)cooking"],
        correctAnswer: 2,
        correctAnswerText: "c)had cooked",
        explanation: "'Before that' indicates that cooking happened before washing. The past perfect 'had cooked' is correct for the earlier action. Why this answer is correct: Had cooked is past perfect, indicating an action completed before another past action. Why other options are incorrect: Cooks is present simple, cooked is simple past, and cooking needs an auxiliary.<br><br><b>Reference:</b> Grammar: Past Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 11,
        question: "The boy ........to go out until he had done the homework.",
        options: ["a)didn't allow", "b)don't allow", "c)wasn't allowed", "d)allowed"],
        correctAnswer: 2,
        correctAnswerText: "c)wasn't allowed",
        explanation: "'Until he had done the homework' implies a condition for permission. 'Wasn't allowed' (passive voice) means he wasn't given permission. Why this answer is correct: Wasn't allowed is passive voice, meaning he was not given permission. Why other options are incorrect: Didn't allow is active, don't allow is present active, and allowed is active past.<br><br><b>Reference:</b> Grammar: Passive Voice."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 12,
        question: "I saw Mr. Tom yesterday. I........him since 2000.",
        options: ["a)didn't", "b)haven't seen", "c) hasn't seen", "d)hadn't seen"],
        correctAnswer: 3, // Changed from highlighted 'b'
        correctAnswerText: "d)hadn't seen",
        explanation: "The first clause is 'I saw Mr. Tom yesterday' (simple past). The second clause uses 'since 2000' and refers to a period *before* 'yesterday'. This requires the past perfect ('hadn't seen') to show that the action of not seeing him extended from 2000 up to the point of seeing him yesterday. Why this answer is correct: Hadn't seen is the past perfect, used for an action that started in the past and continued up to another point in the past. Why other options are incorrect: Didn't is incomplete, haven't seen is present perfect, and hasn't seen is singular present perfect.<br><br><b>Reference:</b> Grammar: Past Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 13,
        question: "By 1970 Egypt .......The High Dam.",
        options: ["a)builds", "b)built", "c)had built", "d)has built"],
        correctAnswer: 2,
        correctAnswerText: "c)had built",
        explanation: "'By 1970' indicates a completion point in the past. The past perfect 'had built' is correct. Why this answer is correct: Had built is the past perfect, indicating completion by a past point. Why other options are incorrect: Builds is present, built is simple past, and has built is present perfect.<br><br><b>Reference:</b> Grammar: Past Perfect."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 14,
        question: "We .......to attend the party until he had sent us an invitation.",
        options: ["a)refused", "b)didn't refuse", "c) refuse", "d)don\"trefuse"],
        correctAnswer: 0,
        correctAnswerText: "a)refused",
        explanation: "To 'refuse to attend' means to decline to go. The past tense fits the context. Why this answer is correct: Refused is the simple past tense, fitting the sequence of events. Why other options are incorrect: Didn't refuse is negative past, refuse is present, and don't refuse is present negative.<br><br><b>Reference:</b> Grammar: Simple Past."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 15,
        question: "After .....the ticket, I felt relaxed and calm.",
        options: ["a) booking", "b)booked", "c)had booked", "d)have booked"],
        correctAnswer: 0,
        correctAnswerText: "a) booking",
        explanation: "'After booking the ticket' uses a gerund after the preposition 'after'. This is a common construction to indicate an action preceding another. Why this answer is correct: After + gerund is the correct structure. Why other options are incorrect: Booked is past participle, had booked is past perfect, and have booked is present perfect.<br><br><b>Reference:</b> Grammar: Gerunds after Prepositions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 1, // New numbering for Unit 11 Test 1
        question: "He is planning to ..........from politics next year.",
        options: ["a)retreat", "b)retire", "c)retrain", "d) reply"],
        correctAnswer: 1,
        correctAnswerText: "b)retire",
        explanation: "To retire from politics means to cease working in that field. Why this answer is correct: Retire means to leave one's job or career. Why other options are incorrect: Retreat means to withdraw, retrain means to teach new skills, and reply means to answer.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 2,
        question: "I am keen on high-tech gadget and the future. I love watching --------films.",
        options: ["a)action", "b)science fiction", "c) horror", "d) historical"],
        correctAnswer: 1,
        correctAnswerText: "b)science fiction",
        explanation: "'High-tech gadget and the future' strongly points to science fiction films. Why this answer is correct: Science fiction fits the themes of high-tech and the future. Why other options are incorrect: Action, horror, and historical are other genres that don't fit the specified theme as well.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 3,
        question: "There are some comedies at the moment. The last one we watched was..........",
        options: ["a) hilariously", "b)miserable", "c) cheerfully", "d) hilarious"],
        correctAnswer: 3,
        correctAnswerText: "d) hilarious",
        explanation: "Hilarious means extremely funny, describing the nature of the comedy. Why this answer is correct: Hilarious means extremely funny, describing a comedy. Why other options are incorrect: Hilariously is an adverb, miserable means very unhappy, and cheerfully is an adverb describing mood.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 4,
        question: ".............is the technique of making films, videos or computer.",
        options: ["a)Introduction", "b)Animation", "c)Direction", "d)tragedy"],
        correctAnswer: 1,
        correctAnswerText: "b)Animation",
        explanation: "Animation is the technique of making films or videos from a sequence of drawings or images. Why this answer is correct: Animation is the process of creating moving images. Why other options are incorrect: Introduction is a beginning, direction is guidance, and tragedy is a serious drama.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_11_TEST_1,
        originalNumber: 5,
        question: "Many people speak in front of me with horror. The synonym of \"horror\" is ..........",
        options: ["a)daring", "b)courage", "c)fear", "d)comfort"],
        correctAnswer: 2,
        correctAnswerText: "c)fear",
        explanation: "Horror is a feeling of intense fear, shock, or disgust. Why this answer is correct: Fear is a direct synonym for horror. Why other options are incorrect: Daring and courage are bravery, and comfort is a state of ease.<br><br><b>Reference:</b> Vocabulary: Synonyms."
    },

    // Unit 12 Test (1) - Page 10
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 6, // Continued numbering from Unit 11 Test 1
        question: "He was fired from his job for his poor ..........",
        options: ["a)performance", "b)direction", "c)form", "d)account"],
        correctAnswer: 0,
        correctAnswerText: "a)performance",
        explanation: "Poor performance means doing one's job badly. Why this answer is correct: Performance refers to how well a task is done. Why other options are incorrect: Direction is guidance, form is shape, and account is a record.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 7,
        question: "The film ........of the novel received a lot of criticism.",
        options: ["a)vacation", "b)version", "c)type", "d)value"],
        correctAnswer: 1,
        correctAnswerText: "b)version",
        explanation: "A film is often a version (an adaptation) of a novel. Why this answer is correct: A version is a particular form of something. Why other options are incorrect: Vacation is a holiday, type is a category, and value is importance.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 8,
        question: "..........means an amusing play, film, etc. that has a happy ending.",
        options: ["a)commonly", "b)comfort", "c)tragedy", "d)comedy"],
        correctAnswer: 3,
        correctAnswerText: "d)comedy",
        explanation: "The definition directly describes a comedy. Why this answer is correct: A comedy is characterized by an amusing plot and happy ending. Why other options are incorrect: Commonly is an adverb, comfort is ease, and tragedy is a serious drama with a sad ending.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 9,
        question: "I think Mona is clever,........?",
        options: ["a) isn't she", "b)is she", "c)doesn't she", "d)do I"],
        correctAnswer: 0,
        correctAnswerText: "a) isn't she",
        explanation: "This is a tag question. The main clause 'I think Mona is clever' has 'is' as the auxiliary, and the subject is 'Mona' (she), so the tag is 'isn't she?'. Why this answer is correct: Isn't she is the correct tag question for 'Mona is clever'. Why other options are incorrect: Is she is positive, doesn't she is for simple present verb, and do I is for 'I think' itself.<br><br><b>Reference:</b> Grammar: Tag Questions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 10,
        question: "Everyone likes their country, ...........?",
        options: ["a)do they", "b)don't they", "c)doesn't he", "d)does he"],
        correctAnswer: 1,
        correctAnswerText: "b)don't they",
        explanation: "For 'Everyone', the pronoun in the tag question is 'they'. 'Likes' is a simple present verb, so the auxiliary is 'do/don't'. The main clause is positive, so the tag is negative: 'don't they?'. Why this answer is correct: Don't they is the correct tag question for 'Everyone likes'. Why other options are incorrect: Do they is positive, doesn't he uses singular, and does he is singular positive.<br><br><b>Reference:</b> Grammar: Tag Questions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 11,
        question: "Nader hardly goes to the cinema, ............?",
        options: ["a)isn't he", "b)doesn'the", "c)does he", "d)doesn't Nader"],
        correctAnswer: 2,
        correctAnswerText: "c)does he",
        explanation: "'Hardly' is a negative adverb, making the main clause negative in meaning. Therefore, the tag question must be positive. 'Goes' is simple present, so the auxiliary is 'does'. The subject is 'Nader' (he). So, 'does he?'. Why this answer is correct: Does he is the correct positive tag for a negative statement with 'hardly'. Why other options are incorrect: Isn't he and doesn't he are negative, and doesn't Nader repeats the name.<br><br><b>Reference:</b> Grammar: Tag Questions."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 12,
        question: "You'd better get up early, ..............?",
        options: ["a)would you", "b)wouldn't you", "c) hadn't you", "d)had you"],
        correctAnswer: 1,
        correctAnswerText: "b)wouldn't you",
        explanation: "The tag question for 'had better' (contracted as 'd better) often uses 'hadn't' or 'wouldn't'. Why this answer is correct: Wouldn't you is a common tag for 'had better'. Why other options are incorrect: Would you is positive, hadn't you is also possible but less common, and had you is positive.<br><br><b>Reference:</b> Grammar: Tag Questions with Had Better."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 13,
        question: "I am good at playing the piano .................?",
        options: ["a)don't I", "b)aren't I", "c)amn't", "d)am I"],
        correctAnswer: 1,
        correctAnswerText: "b)aren't I",
        explanation: "This is a special case for 'I am'. The tag question is 'aren't I?'. Why this answer is correct: Aren't I is the specific tag for 'I am'. Why other options are incorrect: Don't I is for 'I do', amn't is incorrect, and am I is positive.<br><br><b>Reference:</b> Grammar: Tag Questions with I Am."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 14,
        question: "No body hates English, ............?",
        options: ["a)does he", "b)does she", "c)do they", "d)don't they"],
        correctAnswer: 2,
        correctAnswerText: "c)do they",
        explanation: "'Nobody' is a negative subject, so the tag must be positive. 'Nobody' takes a plural pronoun 'they' in the tag. 'Hates' is simple present, so the auxiliary is 'do'. Thus, 'do they?'. Why this answer is correct: Do they is the correct positive tag for 'Nobody'. Why other options are incorrect: Does he/she are singular, and don't they is negative.<br><br><b>Reference:</b> Grammar: Tag Questions with Indefinite Pronouns."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 15,
        question: "Neither of them plays chess, ...........?",
        options: ["a)don't they", "b)do they", "c)aren't they", "d)are they"],
        correctAnswer: 1,
        correctAnswerText: "b)do they",
        explanation: "'Neither of them' makes the main clause negative. The pronoun for 'them' is 'they'. 'Plays' (simple present) takes 'do'. So, the positive tag is 'do they?'. Why this answer is correct: Do they is the correct positive tag for 'Neither of them plays'. Why other options are incorrect: Don't they is negative, and aren't they/are they use 'be' verb.<br><br><b>Reference:</b> Grammar: Tag Questions with Negative Subjects."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 16,
        question: "They never come early, ............?",
        options: ["a)don't they", "b)do they", "c)aren't they", "d)are they"],
        correctAnswer: 1,
        correctAnswerText: "b)do they",
        explanation: "'Never' is a negative adverb, so the tag must be positive. 'Come' is simple present, so the auxiliary is 'do'. The subject is 'they'. So, 'do they?'. Why this answer is correct: Do they is the correct positive tag for a statement with 'never'. Why other options are incorrect: Don't they is negative, and aren't they/are they use 'be' verb.<br><br><b>Reference:</b> Grammar: Tag Questions with Negative Adverbs."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 1, // New numbering for Unit 12 Test 1 vocabulary
        question: "My........in life is to be successful scorer.",
        options: ["a)cause", "b)reason", "c)result", "d)goal"],
        correctAnswer: 3,
        correctAnswerText: "d)goal",
        explanation: "A 'goal' is an aim or desired result. Why this answer is correct: Goal refers to an objective or aim. Why other options are incorrect: Cause is a reason, reason is an explanation, and result is an outcome.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 2,
        question: "This .....aims to help the poor in the village.",
        options: ["a)charity", "b)main", "c)clarity", "d)basic"],
        correctAnswer: 0,
        correctAnswerText: "a)charity",
        explanation: "A charity is an organization set up to provide help to those in need. Why this answer is correct: Charity is an organization providing help to the needy. Why other options are incorrect: Main is primary, clarity is clearness, and basic is fundamental.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 3,
        question: "Finally, Hend managed to ..........her problems.",
        options: ["a)solve", "b)answer", "c)untie", "d)dissolve"],
        correctAnswer: 0,
        correctAnswerText: "a)solve",
        explanation: "To solve problems means to find a solution to them. Why this answer is correct: Solve means to find a solution. Why other options are incorrect: Answer is to respond, untie is to loosen, and dissolve is to break down.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 4,
        question: "He runs his own trucking company. \"Company\", has the same meaning as ........",
        options: ["a)firm", "b)team", "c)group", "d)farm"],
        correctAnswer: 0,
        correctAnswerText: "a)firm",
        explanation: "'Firm' is a synonym for 'company' when referring to a business organization. Why this answer is correct: Firm is a synonym for business company. Why other options are incorrect: Team is a group working together, group is a collection, and farm is land for agriculture.<br><br><b>Reference:</b> Vocabulary: Synonyms."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 5,
        question: "Exercise can have a ......effect on your health and fitness",
        options: ["a) negative", "b)positive", "c)popular", "d)frightening"],
        correctAnswer: 1,
        correctAnswerText: "b)positive",
        explanation: "Exercise generally has a positive effect on health and fitness. Why this answer is correct: Positive effect is a beneficial outcome. Why other options are incorrect: Negative is harmful, popular is well-liked, and frightening causes fear.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 6,
        question: "I can ......my English when I write to my friend.",
        options: ["a)do", "b)make", "c)speak", "d) practise"],
        correctAnswer: 3,
        correctAnswerText: "d) practise",
        explanation: "To practise English means to perform an activity repeatedly to improve one's skill. Why this answer is correct: Practise means to train or exercise a skill. Why other options are incorrect: Do and make are general verbs, speak is to articulate words.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 7,
        question: "It's our duty to.......the planet for future generations",
        options: ["a)investigate", "b)reserve", "c)destroy", "d)preserve"],
        correctAnswer: 3,
        correctAnswerText: "d)preserve",
        explanation: "To preserve the planet means to maintain it in its existing state and protect it from harm. Why this answer is correct: Preserve means to maintain or keep safe. Why other options are incorrect: Investigate is to inquire into, reserve is to hold, and destroy is to ruin.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 8,
        question: "I don't know how he can ........a new car on his salary.",
        options: ["a)produce", "b)afford", "c)attend", "d)apply"],
        correctAnswer: 1,
        correctAnswerText: "b)afford",
        explanation: "To afford something means to have enough financial means to pay for it. Why this answer is correct: Afford means to have enough money to pay for. Why other options are incorrect: Produce is to create, attend is to be present, and apply is to use or request.<br><br><b>Reference:</b> General vocabulary/context."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 9,
        question: "That's my uncle .........house is near us.",
        options: ["a)who", "b)whose", "c)which", "d)where"],
        correctAnswer: 1,
        correctAnswerText: "b)whose",
        explanation: "'Whose' is a possessive pronoun/determiner used to refer to belonging. 'Whose house' means the house belonging to him. Why this answer is correct: Whose indicates possession. Why other options are incorrect: Who is for people, which is for things, and where is for places.<br><br><b>Reference:</b> Grammar: Relative Pronouns."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 10,
        question: "The man .........yesterday is my friend.",
        options: ["a)I met him", "b)I meet", "c)who I met him", "d)I met"],
        correctAnswer: 3,
        correctAnswerText: "d)I met",
        explanation: "The relative pronoun (who/whom) can be omitted when it's the object of the verb in a defining relative clause. 'The man (whom) I met yesterday.' Why this answer is correct: The relative pronoun 'whom' is often omitted when it's the object of the clause. Why other options are incorrect: I met him includes redundant pronoun, I meet is present, and who I met him includes redundant pronoun.<br><br><b>Reference:</b> Grammar: Relative Clauses."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 11,
        question: "Saturday is the day on........i was born.",
        options: ["a)what", "b)when", "c)which", "D)where"],
        correctAnswer: 2,
        correctAnswerText: "c)which",
        explanation: "'On which' is used to refer to a specific day or date. Why this answer is correct: On which refers to the day. Why other options are incorrect: What refers to a thing, when is for time generally, and where is for place.<br><br><b>Reference:</b> Grammar: Relative Pronouns."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 12,
        question: "Alexandria is the place ....Sayed Darwish was born.",
        options: ["a)Who", "b)where", "c)when", "d)how"],
        correctAnswer: 1,
        correctAnswerText: "b)where",
        explanation: "'Where' is a relative adverb used to refer to a place. Why this answer is correct: Where refers to the place. Why other options are incorrect: Who is for people, when is for time, and how is for manner.<br><br><b>Reference:</b> Grammar: Relative Adverbs."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 13,
        question: "Tourists .......stay ended must leave the country",
        options: ["a)whose", "b)who", "c)what", "d)when"],
        correctAnswer: 0, // Changed from highlighted 'b'
        correctAnswerText: "a)whose",
        explanation: "'Whose' is a possessive relative pronoun. It means 'the stay of whom'. The sentence means 'Tourists whose stay ended' (i.e., the stay belonging to the tourists). Why this answer is correct: Whose indicates possession (the stay belonging to the tourists). Why other options are incorrect: Who is for the subject, what refers to a thing, and when is for time.<br><br><b>Reference:</b> Grammar: Relative Pronouns (Possessive)."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 14,
        question: "Did you understand .......I told you?",
        options: ["a)which", "b)what", "c)that", "d)whose"],
        correctAnswer: 1,
        correctAnswerText: "b)what",
        explanation: "'What' refers to the thing or information that was told. Why this answer is correct: What refers to the specific information or thing. Why other options are incorrect: Which is for a choice, that is a relative pronoun, and whose is possessive.<br><br><b>Reference:</b> Grammar: Interrogative/Relative Pronouns."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 15,
        question: "The boy, ........I met yesterday, is from England.",
        options: ["a)who", "b)which", "c)that", "d)whose"],
        correctAnswer: 0, // Highlighted is 'who', but 'whom' is formally correct. Sticking with 'who' per instructions.
        correctAnswerText: "a)who",
        explanation: "In this non-restrictive clause, 'who' (or formally 'whom') is used as the object of the verb 'met'. While 'whom' is grammatically more precise as an object pronoun, 'who' is commonly accepted in modern English for both subject and object in informal and semi-formal contexts. Why this answer is correct: 'Who' is commonly used as an object pronoun in spoken and informal English, though 'whom' is formally correct. Why other options are incorrect: Which is for things, that is a relative pronoun, and whose is possessive.<br><br><b>Reference:</b> Grammar: Relative Pronouns."
    },
    {
        type: 'mcq',
        topic: Topics.UNIT_12_TEST_1,
        originalNumber: 16,
        question: "The thieves, ........last Friday, robbed the bank.",
        options: ["a)who arrested", "b)arrested", "c)been arrested", "d)arresting"],
        correctAnswer: 1, // Highlighted is 'arrested'. This question is problematic.
        correctAnswerText: "b)arrested",
        explanation: "This is a reduced relative clause. 'Arrested' here implies 'who were arrested'. If the thieves were arrested last Friday, it would be illogical for them to then rob the bank. However, grammatically, 'arrested' can function as a past participle in a reduced passive clause (e.g., 'the thieves [who were] arrested'). The full sentence implies a logical inconsistency in the premise itself. Why this answer is correct: 'Arrested' can function as a past participle in a reduced relative clause (e.g., 'the thieves [who were] arrested'). Why other options are incorrect: Who arrested is active (implying the thieves arrested someone), been arrested is incomplete without 'had been' or 'have been', and arresting is present participle.<br><br><b>Reference:</b> Grammar: Reduced Relative Clauses."
    },

    // Translation Section A - Page 11 & 12
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_A,
        originalNumber: 1,
        question: "1-Tourism, industry and agriculture are the sources of our national income",
        options: ["-       ", " -       "],
        correctAnswer: 0,
        correctAnswerText: "-       ",
        explanation: "The phrase '  ' correctly translates 'sources of our national income'. '' also means sources, but '' is a more common and direct translation in this economic context. Why this answer is correct: It precisely translates the phrase 'sources of our national income'. Why other options are incorrect: The second option uses '' which is a less common term for income sources.<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_A,
        originalNumber: 2,
        question: "2-The traffic problem is getting worse and worse as the number of vehicles increases every year.",
        options: [" -           .", "-          ", "-         ", "-          "],
        correctAnswer: 2,
        correctAnswerText: "-         ",
        explanation: "The phrase '   ' accurately translates 'the traffic problem is getting worse'. '    ' correctly translates 'as the number of vehicles increases every year'. Other options either use '' (decrease) or '' (catastrophe) which do not match the original meaning. Why this answer is correct: It correctly translates 'getting worse and worse' and 'as the number of vehicles increases'. Why other options are incorrect: Options 1, 2, and 4 mention '' (decrease) or '' (catastrophe) which are incorrect.<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_A,
        originalNumber: 3,
        question: "3-Egypt is a pioneering country in protecting children against work hazard.",
        options: ["1 -          ", " -          ", "-          ", " -          "],
        correctAnswer: 3,
        correctAnswerText: " -          ",
        explanation: "The translation correctly identifies 'pioneering country' ( ) and 'protecting children against work hazard' (    ). Why this answer is correct: It accurately translates 'pioneering country' and 'protecting children against work hazard'. Why other options are incorrect: Options 1 and 3 use slightly different prepositions or verbs that are less precise. Option 2 states ' ' (big country) which is not 'pioneering'.<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_A,
        originalNumber: 4,
        question: "4-We must exert every possible effort to achieve real economic independence.",
        options: ["-          ", " -          ", "-          ", " -          "],
        correctAnswer: 1,
        correctAnswerText: " -          ",
        explanation: "'     ' translates 'We must exert every possible effort.' '   ' translates 'to achieve real economic independence.' Other options contain subtle errors like ' ' (latent effort), '' (to make/do) instead of '' (to achieve), or '' (natural) instead of '' (real). Why this answer is correct: It precisely translates 'every possible effort' and 'real economic independence'. Why other options are incorrect: Other options contain inaccurate words like '' (latent), '' (for doing/making), or '' (natural).<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_A,
        originalNumber: 5,
        question: "5- Private universities are a useful addition to higher education in Egypt.",
        options: [" -          ", " -         .", "-         .", "-          ."],
        correctAnswer: 0,
        correctAnswerText: " -          ",
        explanation: "The translation correctly renders 'Private universities' ( ), 'useful addition' ( ), and 'higher education' ( ). Why this answer is correct: It correctly translates 'Private universities,' 'useful addition,' and 'higher education.' Why other options are incorrect: Other options refer to ' ' (public universities) or '' (opportunity) instead of '' (addition).<br><br><b>Reference:</b> Translation/Vocabulary."
    },

    // Translation Section B - Page 12 & 13
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_B,
        originalNumber: 1,
        question: " -          .",
        options: ["1-Mass media play a hard role in forming the public opinion", "2-Mass media play a vital role in forming the public opinion .", "3-Mass media play a vital role for forming the private opinion ."],
        correctAnswer: 1,
        correctAnswerText: "2-Mass media play a vital role in forming the public opinion .",
        explanation: "' ' accurately translates to 'vital role' (not 'hard role'). '  ' correctly translates to 'forming the public opinion'. The third option incorrectly says 'private opinion' instead of 'public opinion'. Why this answer is correct: It accurately translates all key phrases: ' ' (Mass media), ' ' (vital role), and '  ' (forming the public opinion). Why other options are incorrect: Option 1 uses 'hard role' instead of 'vital role.' Option 3 uses 'private opinion' instead of 'public opinion.'<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_B,
        originalNumber: 2,
        question: "--            ",
        options: ["1-Government should increase feed production to put an end to starvation", "2-Government can increase food production to put an end to starvation.", "3-Government should increase food production for put an end to starvation.", "4-Government should increase food production to put an end to starvation"],
        correctAnswer: 3,
        correctAnswerText: "4-Government should increase food production to put an end to starvation",
        explanation: "'       ' translates to 'Government should increase food production.' '   ' translates to 'to put an end to starvation.' Option 1 incorrectly uses 'feed production.' Option 2 uses 'can increase' instead of 'should increase.' Option 3 has a grammatical error 'for put an end.' Why this answer is correct: It accurately translates the imperative 'should increase' and the purpose 'to put an end to starvation' with 'food production.' Why other options are incorrect: Option 1 uses 'feed' instead of 'food.' Option 2 uses 'can' instead of 'should.' Option 3 has a grammatical error.<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_B,
        originalNumber: 3,
        question: " -         ",
        options: ["1-pollution is one of the most big problems that threaten our life .", "2-pollution is one of the least serious problems that threaten our life .", "3-pollution is one of the most serious problems that threaten our life .", "4-pollution is one of the most serious problems that can threaten our life."],
        correctAnswer: 2,
        correctAnswerText: "3-pollution is one of the most serious problems that threaten our life .",
        explanation: "' ' accurately translates to 'the most serious problems.' '  ' translates to 'that threaten our life.' Option 1 uses 'most big problems' (awkward grammar). Option 2 uses 'least serious problems' (incorrect meaning). Option 4 uses 'can threaten' (less direct translation). Why this answer is correct: It uses correct superlative 'most serious' and direct translation 'threaten our life.' Why other options are incorrect: Option 1 is grammatically awkward, option 2 is incorrect in meaning, and option 4 uses 'can' which is less direct.<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_B,
        originalNumber: 4,
        question: " -           ",
        options: ["1-Everyone should express our opinions freely and respect the opinion of others", "2-Everyone can express their opinions freely and respect the opinion of others .", "3-Everyone should express his opinions hardly and respect the opinion of others", "4-Everyone should express their opinions freely and respect the opinion of others"],
        correctAnswer: 3,
        correctAnswerText: "4-Everyone should express their opinions freely and respect the opinion of others",
        explanation: "'       ' translates to 'Everyone should express their opinions freely.' '  ' translates to 'and respect the opinion of others.' Option 1 uses 'our opinions' instead of 'their opinions.' Option 2 uses 'can express' instead of 'should express.' Option 3 uses 'hardly' instead of 'freely.' Why this answer is correct: It perfectly translates ' ' (Everyone), '     ' (should express their opinions freely), and '  ' (respect the opinion of others). Why other options are incorrect: Option 1 uses 'our opinions' (incorrect pronoun). Option 2 uses 'can' (modality change). Option 3 uses 'hardly' (incorrect adverb).<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_B,
        originalNumber: 5,
        question: " -            ",
        options: ["1-Laws are made to protect people from behaving badly towards each other", "2-Laws are made to infect people from behaving badly towards each other", "3-Laws are made to prevent people from behaving bad towards each other", "4-Laws are made to prevent people from behaving badly towards one another ."],
        correctAnswer: 0,
        correctAnswerText: "1-Laws are made to protect people from behaving badly towards each other",
        explanation: "'    ' translates to 'Laws are made to protect people.' '      ' translates to 'from behaving badly towards each other.' Option 2 uses 'infect' instead of 'protect.' Options 3 and 4 use 'prevent' (which is possible but 'protect' is more direct for '') and grammatical error 'behaving bad' or 'one another' instead of 'each other.' Why this answer is correct: It uses 'protect' for '' and 'behaving badly towards each other' correctly. Why other options are incorrect: Option 2 uses 'infect' (wrong meaning). Option 3 has a grammatical error ('bad'). Option 4 uses 'one another' instead of 'each other' which is less common in this context.<br><br><b>Reference:</b> Translation/Vocabulary."
    },
    {
        type: 'mcq',
        topic: Topics.TRANSLATION_B,
        originalNumber: 6,
        question: " -         ",
        options: ["1-The government is carrying out different projects to help the youth", "2-The government is carrying out different places to help the youth.", "3-The government is carrying in different projects to help the youth.", "4-The government is carrying out many projects to help the youth."],
        correctAnswer: 0,
        correctAnswerText: "1-The government is carrying out different projects to help the youth",
        explanation: "'      ' translates to 'The government is carrying out many/different projects.' ' ' translates to 'to help the youth.' Option 2 uses 'places' instead of 'projects.' Option 3 uses incorrect preposition 'in' instead of 'out.' Option 4 uses 'many projects' instead of 'different projects' for ' ' (which means varied/different, though 'many' is also implied by ''). The highlighted option is the most precise. Why this answer is correct: It accurately translates 'carrying out different projects' and 'to help the youth.' Why other options are incorrect: Option 2 uses 'places' instead of 'projects.' Option 3 has a grammatical error with 'carrying in.' Option 4 uses 'many' instead of 'different' for ''.<br><br><b>Reference:</b> Translation/Vocabulary."
    },

    // The Play: Essay Questions - Page 14
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 1,
        question: "Why do you think Gloucester asks Kent to drive the King to Dover?",
        correctAnswerText: "Gloucester asks Kent to drive the King to Dover because he wants to ensure Lear's safety and help him escape the cruel treatment from Goneril and Regan. He hopes Lear can find refuge and help from Cordelia (or the French forces) there.",
        explanation: "Gloucester, though blinded and suffering, retains loyalty to Lear. He recognizes Lear's vulnerability and seeks to protect him from his cruel daughters. Dover is strategically important as it is where Cordelia and the French army are expected to land, offering a chance for Lear's salvation.<br><br><b>Reference:</b> The Play (King Lear), Act IV."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 2,
        question: "What shows that Kent is loyal to the king?",
        correctAnswerText: "Kent's loyalty is shown by his disguised service to Lear after being banished, enduring the storm with him, and actively working to reunite Lear with Cordelia in Dover to secure his well-being. Driving him to Dover is one key action.",
        explanation: "Kent's loyalty is unwavering. Despite being banished by Lear, he immediately disguises himself as Caius and continues to serve Lear faithfully, protecting him, accompanying him through the storm, and ultimately facilitating his reunion with Cordelia, prioritizing Lear's welfare above all.<br><br><b>Reference:</b> The Play (King Lear), Acts II-IV."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 3,
        question: "Why do you think Edgar pretends to be a beggar?",
        correctAnswerText: "Edgar pretends to be a beggar (Poor Tom) to disguise himself and escape from his brother Edmund's treacherous plot to have him killed. This disguise also allows him to stay hidden and eventually help his blinded father, Gloucester.",
        explanation: "Edgar adopts the disguise of Poor Tom, a mad beggar, to evade capture and death after Edmund falsely accuses him of treason. This desperate measure allows him to remain hidden while observing the unfolding tragedies and eventually helping his father.<br><br><b>Reference:</b> The Play (King Lear), Act II."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 4,
        question: "Why do you think Albany doesn't trust Edmund?",
        correctAnswerText: "Albany doesn't trust Edmund because he gradually recognizes Edmund's manipulative and treacherous nature, especially after witnessing the harm he inflicts on his own father, Gloucester, and realizing Edmund's ambition and disloyalty.",
        explanation: "Albany initially seems passive but gradually becomes aware of Goneril's wickedness and Edmund's duplicity. He sees Edmund's opportunism, his disregard for family ties, and his ambition, which leads him to distrust Edmund's motives and actions, especially after Gloucester's blinding.<br><br><b>Reference:</b> The Play (King Lear), Act IV."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 5,
        question: "Why can't the king trust the daughters Goneril and Regan?",
        correctAnswerText: "King Lear cannot trust Goneril and Regan because they made false declarations of love and loyalty to gain power and then immediately stripped him of his authority, dignity, and followers, revealing their true, cruel, and selfish intentions.",
        explanation: "Lear's trust is shattered as Goneril and Regan progressively diminish his retinue, demand he dismiss his knights, and deny him shelter. Their actions directly contradict their initial extravagant declarations of love, exposing their hypocrisy and greed for power.<br><br><b>Reference:</b> The Play (King Lear), Acts I-II."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 6,
        question: "Why is Edgar surprised when he sees the king and his father?",
        correctAnswerText: "Edgar is surprised and deeply shocked when he sees the King and his father because both have suffered immensely and been driven to extreme states: Lear has gone mad, and Gloucester has been blinded. Their tragic fates are beyond what he could have imagined.",
        explanation: "Edgar is shocked to witness Lear's profound madness and Gloucester's physical blinding. The extent of their suffering and degradation, brought about by the cruelty of those they trusted, is horrifying and unimaginable, deeply affecting Edgar.<br><br><b>Reference:</b> The Play (King Lear), Act IV."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 7,
        question: "Why do you think Regan and Goneril want Edmund's help?",
        correctAnswerText: "Regan and Goneril want Edmund's help because they are both ambitious and ruthless, seeking to consolidate their power and undermine each other. They see Edmund as a valuable ally (and a romantic interest) due to his cunning and willingness to betray for personal gain.",
        explanation: "Both sisters are drawn to Edmund's ruthlessness and ambition. They desire his strategic cunning and military prowess to further their own political power and to eliminate Albany, and they are also sexually attracted to him, seeing him as a means to consolidate their personal and political influence.<br><br><b>Reference:</b> The Play (King Lear), Act IV."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 8,
        question: "Why do you think that Lear kneels before Cordelia?",
        correctAnswerText: "Lear kneels before Cordelia as a profound act of humility and repentance. He recognizes his terrible injustice towards her and the depth of his folly, seeking her forgiveness for his past actions and expressing his sorrow.",
        explanation: "Lear's act of kneeling is a powerful symbolic gesture. It signifies his profound remorse and the crushing realization of his past errors, particularly his wrongful banishment of Cordelia. It demonstrates his regained sanity and deep humility in seeking forgiveness from the daughter he wronged.<br><br><b>Reference:</b> The Play (King Lear), Act IV."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 9,
        question: "Why do you think Edmund wants to fight Albany?",
        correctAnswerText: "Edmund wants to fight Albany because Albany has publicly accused him of treason, exposed his plots against Gloucester and his alliance with Goneril and Regan, and represents the legitimate authority that challenges Edmund's usurped power.",
        explanation: "Edmund's desire to fight Albany stems from Albany's rightful accusation of treason and the challenge Albany poses to Edmund's ambition and newly acquired power. Albany represents the moral order and justice that Edmund has undermined, making him a direct obstacle to Edmund's complete ascendancy.<br><br><b>Reference:</b> The Play (King Lear), Act V."
    },
    {
        type: 'essay',
        topic: Topics.THE_PLAY_ESSAYS,
        originalNumber: 10,
        question: "Write an essay about one of the following topics: 1- Tourism, 2- New Technology, 3- Sport, 4- Health, 5- The pros and cons of the mobile",
        correctAnswerText: "This question prompts an essay on one of five given topics. The exact content will vary depending on the chosen topic. A well-structured essay would include an introduction, body paragraphs with supporting details, and a conclusion. For example, for 'Tourism', one might discuss its economic benefits, cultural exchange, and potential environmental impacts. For 'New Technology', topics could include AI, automation, and their societal impacts. For 'Sport', benefits like health, teamwork, and national pride could be covered. 'Health' could encompass mental and physical well-being, healthy habits, and healthcare systems. 'The pros and cons of the mobile' would explore convenience, communication, and access to information as pros, versus addiction, privacy concerns, and digital distraction as cons.",
        explanation: "This is an open-ended essay prompt testing the student's ability to structure an argument, present ideas logically, and support them with details on a given topic. The explanation provides a general framework and examples for each topic. Students should choose one topic and develop a coherent essay.<br><br><b>Reference:</b> General essay writing skills."
    },
];


        const quotes = [
            "The only way to do great work is to love what you do.  Steve Jobs",
            "Education is the most powerful weapon which you can use to change the world.  Nelson Mandela",
            "The future belongs to those who believe in the beauty of their dreams.  Eleanor Roosevelt",
            "Strive for progress, not perfection.",
            "The expert in anything was once a beginner.",
            "Don't watch the clock; do what it does. Keep going.",
            "Success is not final, failure is not fatal: It is the courage to continue that counts.  Winston Churchill",
            "The mind is not a vessel to be filled, but a fire to be kindled.  Plutarch",
            "Study hard what interests you the most in the most undisciplined, irreverent and original manner possible.  Richard Feynman",
            "Learning never exhausts the mind.  Leonardo da Vinci"
        ];


        let currentQuestionIndex = 0;
        let score = 0;
        let buttonsDisabled = false; // Controls user input on answer/skip buttons / self-correction buttons / reveal button
        let gameInProgress = false; // Controls overall game state
        let currentTopicQuestions = [];
        let lessonAttempts = []; // To store results for PDF: Incorrect MCQs, Skipped MCQs, Self-corrected Wrong Essays
        let questionsToRemember = []; // To store questions added to remember list for PDF: Correct MCQs (if button clicked), Self-corrected Correct Essays (if button clicked)

        // Get DOM elements
        const lessonSelectionElement = document.getElementById('lesson-selection');
        const gameContainerElement = document.querySelector('.game-container');
        const gameTitleElement = document.getElementById('game-title');
        const questionCounterElement = document.querySelector('.question-counter');
        const currentQNumElement = document.getElementById('current-q-num');
        const totalQNumElement = document.getElementById('total-q-num');
        const questionAreaElement = document.getElementById('question-area');
        const questionTextElement = document.getElementById('question-text');
        const answerButtonsElement = document.getElementById('answer-buttons'); // MCQ buttons container
        const revealAnswerButton = document.getElementById('reveal-answer-button'); // New Reveal button
        const essaySelfCorrectionButtonsElement = document.getElementById('essay-self-correction-buttons'); // Essay buttons container
        const feedbackElement = document.getElementById('feedback');
        const explanationAreaElement = document.getElementById('explanation-area');
        const explanationTextElement = document.getElementById('explanation-text');
        const scoreAreaElement = document.getElementById('score-area');
        const scoreElement = document.getElementById('score');
        const skipButton = document.getElementById('skip-button'); // Skip button (only for MCQ)
        const nextButton = document.getElementById('next-button');
        const addToRememberButton = document.getElementById('add-to-remember-button'); // Add to Remember button
        const finalScoreElement = document.getElementById('final-score');
        const finalScoreTextElement = document.getElementById('final-score-text');
        const finalTotalTextElement = document.getElementById('final-total-text');
        const restartButton = document.getElementById('restart-button');
        const downloadPdfButton = document.getElementById('download-mistakes-pdf');
        const exportAllPdfButton = document.getElementById('export-all-pdf-button'); // Export All button
        const quoteAreaElement = document.getElementById('quote-area');
        const currentQuoteElement = document.getElementById('current-quote');

         // Create self-correction buttons once and manage their visibility
        const correctEssayButton = document.createElement('button');
        correctEssayButton.textContent = 'I got it Right!';
        correctEssayButton.classList.add('self-correct-button');
        // Event listener added in revealAnswer()

        const wrongEssayButton = document.createElement('button');
        wrongEssayButton.textContent = 'I was Wrong';
        wrongEssayButton.classList.add('self-correct-button', 'wrong');
        // Event listener added in revealAnswer()

        // Append them to the container, they will be hidden by default via CSS .hidden
        essaySelfCorrectionButtonsElement.appendChild(correctEssayButton);
        essaySelfCorrectionButtonsElement.appendChild(wrongEssayButton);

         // Add event listener for the new Reveal Answer button
         revealAnswerButton.addEventListener('click', revealAnswer);


        // --- Functions ---

        function showLessonSelection() {
            console.log("Executing showLessonSelection()"); // Debug log
            gameInProgress = false;
            // Hide game elements
            gameContainerElement.classList.add('hidden');
            finalScoreElement.classList.add('hidden');
            explanationAreaElement.classList.add('hidden');
            explanationAreaElement.classList.remove('visible'); // Remove animation class
            addToRememberButton.classList.add('hidden'); // Hide remember button
            quoteAreaElement.classList.add('hidden'); // Hide quote area
            questionCounterElement.classList.add('hidden'); // Hide counter
            questionAreaElement.classList.add('hidden'); // Hide question area too

            // Show lesson selection
            lessonSelectionElement.classList.remove('hidden');

            // Clear existing buttons before adding new ones
             while (lessonSelectionElement.firstChild) {
                 lessonSelectionElement.removeChild(lessonSelectionElement.firstChild);
             }
             // Add back the h2 title
             const title = document.createElement('h2');
             title.innerHTML = 'Welcome!<br>Choose a Lesson'; // Use innerHTML for the <br> tag
             lessonSelectionElement.appendChild(title);

            console.log("Adding lesson buttons..."); // Debug log
            for (const topicKey in Topics) {
                const topicName = Topics[topicKey];
                // Check if there are questions for this topic before adding the button
                const questionsForTopic = allQuestions.filter(q => q.topic === topicName);
                console.log(`Found ${questionsForTopic.length} questions for topic: ${topicName}`); // Debug log
                if (questionsForTopic.length > 0) {
                    const btn = document.createElement("button");
                    btn.classList.add("action-button");
                    btn.innerText = `${topicName} (${questionsForTopic.length} Questions)`;
                    btn.addEventListener('click', () => startGame(topicName));
                    lessonSelectionElement.appendChild(btn);
                }
            }
            console.log("showLessonSelection() finished."); // Debug log
        }

        function startGame(topic) {
            console.log(`Executing startGame() for topic: ${topic}`); // Debug log
            gameInProgress = true;

            // Filter questions based on the chosen topic (maintaining original order)
            currentTopicQuestions = allQuestions
                .filter(q => q.topic === topic);

            if (currentTopicQuestions.length === 0) {
                console.error(`No questions found for the topic: ${topic}`); // Debug log
                alert(`No questions found for the topic: ${topic}`);
                showLessonSelection(); // Go back to selection if no questions
                return;
            }
            console.log(`Starting game with ${currentTopicQuestions.length} questions.`); // Debug log

            // Reset game state
            currentQuestionIndex = 0;
            score = 0;
            lessonAttempts = []; // Clear attempts for the new lesson
            questionsToRemember = []; // Clear remember list for the new lesson
            scoreElement.textContent = score;
            totalQNumElement.textContent = currentTopicQuestions.length; // Update total count

            // Update game title
            gameTitleElement.textContent = `${topic}`; // Updated title

            // Hide lesson selection
            lessonSelectionElement.classList.add('hidden');

            // Show game elements
            gameContainerElement.classList.remove('hidden');
            questionAreaElement.classList.remove('hidden'); // Ensure question area is shown
            feedbackElement.classList.remove('hidden');
            scoreAreaElement.classList.remove('hidden');
            quoteAreaElement.classList.remove('hidden');
            questionCounterElement.classList.remove('hidden'); // Show question counter

            // Hide end game elements
            finalScoreElement.classList.add('hidden');
            nextButton.classList.add('hidden');
            restartButton.classList.add('hidden');
            downloadPdfButton.classList.add('hidden');
            exportAllPdfButton.classList.add('hidden'); // Hide export all button

            displayQuestion();
            displayRandomQuote();
            console.log("startGame() finished."); // Debug log
        }

        function displayQuestion() {
            console.log(`Executing displayQuestion() for index ${currentQuestionIndex}`); // Debug log
            resetState(); // Clears feedback, explanation, buttons, etc.
            buttonsDisabled = false; // Re-enable input

            const question = currentTopicQuestions[currentQuestionIndex];

            if (!question) {
                console.error("Error: Could not load next question. Index out of bounds or no questions found."); // Debug log
                questionTextElement.innerHTML = "Error: Could not load next question."; // Use innerHTML for potential HTML
                buttonsDisabled = true;
                // Hide all action buttons on error
                nextButton.classList.add('hidden');
                skipButton.classList.add('hidden');
                addToRememberButton.classList.add('hidden');
                revealAnswerButton.classList.add('hidden');
                essaySelfCorrectionButtonsElement.classList.add('hidden');
                 quoteAreaElement.classList.add('hidden'); // Hide quote area on error
                setTimeout(() => restartButton.classList.remove('hidden'), 2000);
                return;
            }

            // Update question counter
            currentQNumElement.textContent = currentQuestionIndex + 1;
            console.log(`--- Displaying Question ${currentQuestionIndex + 1} (Original #${question.originalNumber}, Type: ${question.type}) ---`); // Log question start

            questionTextElement.innerHTML = question.question; // Use innerHTML

            // --- Handle different question types ---
            if (question.type === 'mcq') {
                console.log("Question type is MCQ. Setting up MCQ buttons."); // Debug log
                answerButtonsElement.classList.remove('hidden'); // Show MCQ container
                revealAnswerButton.classList.add('hidden'); // Hide reveal for MCQ
                essaySelfCorrectionButtonsElement.classList.add('hidden'); // Hide essay buttons
                skipButton.classList.remove('hidden'); // Show the skip button for MCQ
                skipButton.disabled = false; // Enable the skip button

                 if (!question.options || !Array.isArray(question.options) || question.options.length === 0) {
                     console.error("MCQ question is missing options:", question); // Debug log
                     questionTextElement.innerHTML = `Error loading MCQ question ${question.originalNumber}. Please check the question data.`; // Use innerHTML
                     buttonsDisabled = true;
                     // Hide all action buttons on error
                     skipButton.classList.add('hidden');
                     addToRememberButton.classList.add('hidden');
                     revealAnswerButton.classList.add('hidden');
                      essaySelfCorrectionButtonsElement.classList.add('hidden');
                      quoteAreaElement.classList.add('hidden'); // Hide quote area on error
                     if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                         setTimeout(() => { nextButton.classList.remove('hidden'); console.log("Showing Next button after MCQ error."); }, 800);
                     } else {
                         setTimeout(endGame, 1000);
                     }
                     return;
                 }


                answerButtonsElement.innerHTML = ''; // Clear previous MCQ buttons effectively
                question.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.innerHTML = option; // Use innerHTML
                    button.classList.add('answer-button');
                    button.dataset.index = index;

                    // Use an anonymous function to call selectAnswer with the correct index
                    button.addEventListener('click', () => selectAnswer(index));
                    answerButtonsElement.appendChild(button);
                });
                 console.log(`${question.options.length} MCQ buttons added.`); // Debug log

            } else if (question.type === 'essay') {
                console.log("Question type is Essay. Setting up Reveal button."); // Debug log
                answerButtonsElement.classList.add('hidden'); // Hide MCQ buttons
                skipButton.classList.add('hidden'); // Hide the skip button for essay
                essaySelfCorrectionButtonsElement.classList.add('hidden'); // Hide essay buttons initially
                explanationAreaElement.classList.add('hidden'); // Hide explanation initially for essay
                explanationAreaElement.classList.remove('visible'); // Remove animation class
                 addToRememberButton.classList.add('hidden'); // Hide remember button initially for essay

                 // Show and enable the Reveal Answer button
                 revealAnswerButton.classList.remove('hidden');
                 revealAnswerButton.disabled = false;
                 console.log("Reveal Answer button shown."); // Debug log

            } else {
                // Handle unknown question types
                 console.error("Error: Question has unknown type:", question); // Debug log
                 questionTextElement.innerHTML = `Error loading question ${question.originalNumber} (Unknown type). Please check the question data.`; // Use innerHTML
                 buttonsDisabled = true;
                  // Hide all action buttons on error
                 skipButton.classList.add('hidden');
                 addToRememberButton.classList.add('hidden');
                 revealAnswerButton.classList.add('hidden');
                  essaySelfCorrectionButtonsElement.classList.add('hidden');
                  quoteAreaElement.classList.add('hidden'); // Hide quote area on error
                 if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                     setTimeout(() => { nextButton.classList.remove('hidden'); console.log("Showing Next button after unknown type error."); }, 800);
                 } else {
                     setTimeout(endGame, 1000);
                 }
                 return;
            }
            console.log("displayQuestion() finished."); // Debug log
        }

        function resetState() {
            console.log("Executing resetState()"); // Debug log
            // Clear previous answer buttons (MCQ) and hide their container
             answerButtonsElement.innerHTML = '';
             answerButtonsElement.classList.add('hidden'); // Ensure MCQ buttons are hidden by default


            // Hide essay self-correction buttons
            essaySelfCorrectionButtonsElement.classList.add('hidden');
             correctEssayButton.disabled = true; // Disable them when hidden
             wrongEssayButton.disabled = true;

             // Hide reveal answer button
             revealAnswerButton.classList.add('hidden');
             revealAnswerButton.disabled = true;


            feedbackElement.textContent = '';
            feedbackElement.style.color = '';
            explanationAreaElement.classList.add('hidden');
            explanationAreaElement.classList.remove('visible');
            explanationTextElement.innerHTML = ''; // Use innerHTML
            nextButton.classList.add('hidden');
            skipButton.classList.add('hidden'); // Hide skip button by default, displayQuestion will show for MCQ

            // Reset Add to Remember button state explicitly
            console.log("Resetting 'Add to Remember' button state."); // Debug log
            addToRememberButton.classList.add('hidden'); // Hide the button
            addToRememberButton.disabled = false; // Ensure it's enabled
            addToRememberButton.textContent = "Add to Remember List"; // Reset text

             // Remove any event listeners added in revealAnswer to prevent duplicates on subsequent questions
             // Need to clone node or use removeEventListener properly - check how listeners are added
             // Listeners for correct/wrong essay buttons are added *in* revealAnswer. Removing them here is correct.
             // No need to remove listeners from MCQ buttons as they are replaced via innerHTML = ''
             // Global listeners (skip, next, remember, reveal, restart, download, export) are attached once and persist.
             correctEssayButton.removeEventListener('click', handleSelfCorrectionRight);
             wrongEssayButton.removeEventListener('click', handleSelfCorrectionWrong);

             console.log("resetState() complete. Add to Remember button state:", { hidden: addToRememberButton.classList.contains('hidden'), disabled: addToRememberButton.disabled, text: addToRememberButton.textContent }); // Debug log
        }

        // Handle MCQ answer selection
        function selectAnswer(selectedIndex) {
            if (buttonsDisabled) {
                console.log("selectAnswer() called but buttonsDisabled is true."); // Debug log
                return; // Prevent double-clicking
            }
            const question = currentTopicQuestions[currentQuestionIndex];

            // Ensure this is an MCQ, although displayQuestion should prevent calling this
             if (question.type !== 'mcq') {
                 console.warn("selectAnswer() called for non-MCQ type:", question); // Debug log
                 return; // Should not happen if displayQuestion works correctly
             }

            buttonsDisabled = true; // Disable input once an answer is chosen
            console.log(`Executing selectAnswer(${selectedIndex}) for Original #${question.originalNumber}. buttonsDisabled set to true.`); // Debug log


            // Disable and hide the skip button immediately
            skipButton.disabled = true;
            skipButton.classList.add('hidden');
            console.log("Skip button disabled and hidden."); // Debug log


            // Disable all answer buttons
            const answerButtons = answerButtonsElement.querySelectorAll('.answer-button');
            answerButtons.forEach(button => button.disabled = true);
             console.log("All MCQ buttons disabled."); // Debug log


            const isCorrect = (selectedIndex === question.correctAnswer);
            console.log(`MCQ Answer Selected (Index ${selectedIndex}): Is Correct? ${isCorrect}`); // Debug log

            // Record the attempt ONLY IF INCORRECT. Skipped is handled in skipQuestion. Self-corrected handled in handleSelfCorrection.
            // Correct MCQ attempts are NOT added to lessonAttempts automatically.
            if (!isCorrect) {
                lessonAttempts.push({
                    type: 'mcq', // Store type in attempt
                    originalNumber: question.originalNumber, // Include original number
                    questionText: question.question, // Keep original HTML
                    selectedAnswer: question.options[selectedIndex], // Keep original HTML
                    correctAnswerText: question.correctAnswerText, // Keep original HTML
                    options: question.options, // Keep original HTML options list
                    explanation: question.explanation, // Keep original HTML
                    isCorrect: false, // Will be false here
                    topic: question.topic,
                    // isRememberedItem is only added to questionsToRemember list
                });
                console.log(`MCQ Answered Incorrectly (Original #${question.originalNumber}). Added to lessonAttempts. lessonAttempts size: ${lessonAttempts.length}`); // Debug log
            }


            // Highlight buttons
            answerButtons.forEach((button, index) => {
                if (index === question.correctAnswer) {
                    button.classList.add('correct');
                } else if (index === selectedIndex) {
                    button.classList.add('incorrect');
                }
            });
             console.log("Answer buttons styled."); // Debug log


            if (isCorrect) {
                score++;
                scoreElement.textContent = score;
                feedbackElement.textContent = 'Correct!';
                feedbackElement.style.color = '#28a745'; // Green
                console.log("Answer was Correct. Score updated."); // Debug log

                // Show and check state of Add to Remember button ONLY if correct
                console.log("Showing 'Add to Remember' button after correct MCQ."); // Debug log
                addToRememberButton.classList.remove('hidden');
                checkRememberButtonState(question); // Check if already added and set state/text

            } else {
                feedbackElement.textContent = `Incorrect.`;
                feedbackElement.style.color = '#dc3545'; // Red
                console.log("Answer was Incorrect. Hiding 'Add to Remember' button."); // Debug log
                addToRememberButton.classList.add('hidden'); // Ensure hidden if incorrect
            }

            // Display explanation with animation (includes correct answer)
            // Construct explanation HTML to include Correct Answer text for display
            const explanationHtml = `<strong>Correct Answer:</strong> ${question.correctAnswerText}<br><br><strong>Explanation:</strong> ${question.explanation}`;
            explanationTextElement.innerHTML = explanationHtml; // Use innerHTML
            explanationAreaElement.classList.remove('hidden');
            setTimeout(() => {
                explanationAreaElement.classList.add('visible');
                 console.log("Explanation area visible."); // Debug log
            }, 10);


            // Determine next action after a delay
            if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                setTimeout(() => {
                    nextButton.classList.remove('hidden');
                    console.log("Showing Next button after MCQ answer."); // Debug log
                }, 800); // Faster timeout
            } else {
                // This is the last question
                console.log("Last question answered. Ending game soon."); // Debug log
                setTimeout(endGame, 1200); // Faster endgame
            }
             console.log("selectAnswer() finished."); // Debug log
        }

         // Handle clicking the Reveal Answer button for essay questions
         function revealAnswer() {
             if (buttonsDisabled) {
                 console.log("revealAnswer() called but buttonsDisabled is true."); // Debug log
                 return; // Prevent double-clicking
             }
             buttonsDisabled = true; // Disable input temporarily
             console.log(`Executing revealAnswer() for Original #${currentTopicQuestions[currentQuestionIndex].originalNumber}. buttonsDisabled set to true.`); // Debug log


             const question = currentTopicQuestions[currentQuestionIndex];
             if (question.type !== 'essay') {
                  console.warn("revealAnswer() called for non-essay type:", question); // Debug log
                  buttonsDisabled = false; // Re-enable if it was a mistake
                  return;
             }

             console.log(`Revealing answer for Essay Question (Original #${question.originalNumber})`); // Debug log

             // Disable and hide the Reveal button
             revealAnswerButton.disabled = true;
             revealAnswerButton.classList.add('hidden');
             console.log("Reveal Answer button disabled and hidden."); // Debug log


             // Display explanation with animation (includes model answer)
             const explanationHtml = `<strong>Model Answer:</strong> ${question.correctAnswerText}<br><br><strong>Explanation:</strong> ${question.explanation}`;
             explanationTextElement.innerHTML = explanationHtml; // Use innerHTML
             explanationAreaElement.classList.remove('hidden');
             setTimeout(() => {
                 explanationAreaElement.classList.add('visible');
                  console.log("Explanation area visible after revealing answer."); // Debug log
             }, 10);


             // Now show and enable the self-correction buttons after a slight delay
             setTimeout(() => {
                  console.log("Showing essay self-correction buttons."); // Debug log
                  essaySelfCorrectionButtonsElement.classList.remove('hidden');
                  correctEssayButton.disabled = false;
                  wrongEssayButton.disabled = false;
                  buttonsDisabled = false; // Re-enable input for self-correction buttons
                   console.log("Self-correction buttons enabled. buttonsDisabled set to false."); // Debug log

                  // Add listeners *only* after they are revealed and enabled
                  // These listeners are removed in resetState
                  correctEssayButton.addEventListener('click', handleSelfCorrectionRight);
                  wrongEssayButton.addEventListener('click', handleSelfCorrectionWrong);

             }, 500); // Small delay before showing correction buttons
              console.log("revealAnswer() finished."); // Debug log
         }

         // Separate handlers for clarity and easier listener removal
         function handleSelfCorrectionRight() {
             handleSelfCorrection(true);
         }

         function handleSelfCorrectionWrong() {
             handleSelfCorrection(false);
         }


        // Handle Essay self-correction
        function handleSelfCorrection(isCorrect) {
            if (buttonsDisabled) {
                 console.log(`handleSelfCorrection(${isCorrect}) called but buttonsDisabled is true.`); // Debug log
                return; // Prevent double-clicking
            }
             const question = currentTopicQuestions[currentQuestionIndex];

            // Ensure this is an Essay
             if (question.type !== 'essay') {
                 console.warn("handleSelfCorrection() called for non-essay type:", question); // Debug log
                  return; // Should not happen
             }

            buttonsDisabled = true; // Disable input once self-corrected
            console.log(`Executing handleSelfCorrection(${isCorrect}) for Original #${question.originalNumber}. buttonsDisabled set to true.`); // Debug log


            // Disable self-correction buttons immediately
             correctEssayButton.disabled = true;
             wrongEssayButton.disabled = true;
             essaySelfCorrectionButtonsElement.classList.add('hidden'); // Hide the container
             console.log("Self-correction buttons disabled and hidden."); // Debug log

             // Remove listeners to prevent them from firing again
             correctEssayButton.removeEventListener('click', handleSelfCorrectionRight);
             wrongEssayButton.removeEventListener('click', handleSelfCorrectionWrong);
             console.log("Self-correction button listeners removed."); // Debug log


             if (isCorrect) {
                score++;
                scoreElement.textContent = score;
                feedbackElement.textContent = 'Marked as Correct!';
                feedbackElement.style.color = '#28a745'; // Green
                 console.log("Marked Right. Score updated."); // Debug log

                // Show and check state of "Add to Remember" button after self-correcting as correct
                 console.log("Showing 'Add to Remember' button after correct self-correction."); // Debug log
                 addToRememberButton.classList.remove('hidden');
                 checkRememberButtonState(question); // Set button text and state

             } else {
                feedbackElement.textContent = `Marked as Incorrect.`;
                feedbackElement.style.color = '#dc3545'; // Red
                 console.log("Marked Wrong. Hiding 'Add to Remember' button. Added to lessonAttempts."); // Debug log
                 addToRememberButton.classList.add('hidden'); // Ensure hidden if incorrect

                 // Record the attempt as self-corrected wrong
                lessonAttempts.push({
                    type: 'essay', // Store type in attempt
                    originalNumber: question.originalNumber,
                    questionText: question.question, // Include question text
                    selectedAnswer: "[Self-Corrected as Wrong]", // Indicate it was self-corrected wrong
                    correctAnswerText: question.correctAnswerText, // Include correct answer text (model answer)
                    options: [], // No options for essay
                    explanation: question.explanation, // Include explanation
                    isCorrect: false, // Mark as incorrect/missed for filtering
                    topic: question.topic,
                });
                 console.log(`Added to lessonAttempts. lessonAttempts size: ${lessonAttempts.length}`); // Debug log
             }

            // Explanation is already visible from revealAnswer()


            // Determine next action after a delay
            if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                setTimeout(() => {
                    nextButton.classList.remove('hidden');
                     console.log("Showing Next button after essay self-correction."); // Debug log
                }, 800); // Faster timeout
            } else {
                 console.log("Last question self-corrected. Ending game soon."); // Debug log
                setTimeout(endGame, 1200);
            }
            console.log("handleSelfCorrection() finished."); // Debug log
        }


        // Handle MCQ skip
        function skipQuestion() {
            if (buttonsDisabled) {
                 console.log("skipQuestion() called but buttonsDisabled is true."); // Debug log
                return; // Prevent double-clicking
            }
            const question = currentTopicQuestions[currentQuestionIndex];
             // Ensure this is an MCQ
            if (question.type !== 'mcq') {
                 console.warn("skipQuestion() called for non-MCQ type:", question); // Debug log
                 return; // Should not happen
            }

            buttonsDisabled = true; // Disable input once skip is clicked
            console.log(`Executing skipQuestion() for Original #${question.originalNumber}. buttonsDisabled set to true.`); // Debug log


            // Disable and hide the skip button immediately
            skipButton.disabled = true;
            skipButton.classList.add('hidden');
             console.log("Skip button disabled and hidden."); // Debug log

            // Disable all answer buttons
            const answerButtons = answerButtonsElement.querySelectorAll('.answer-button');
            answerButtons.forEach(button => button.disabled = true);
             console.log("All MCQ buttons disabled."); // Debug log


            // Record the attempt as skipped/incorrect
             lessonAttempts.push({
                type: 'mcq', // Store type in attempt
                originalNumber: question.originalNumber,
                questionText: question.question, // Include question text
                selectedAnswer: "[Skipped]", // Indicate it was skipped
                correctAnswerText: question.correctAnswerText, // Include correct answer text
                options: question.options, // Include options
                explanation: question.explanation, // Include explanation
                isCorrect: false, // Mark as incorrect/missed for filtering
                topic: question.topic,
                // Do NOT add isRememberedItem: true here
            });
             console.log(`Skipped MCQ Question (Original #${question.originalNumber}). Added to lessonAttempts. lessonAttempts size: ${lessonAttempts.length}`); // Debug log


            // Provide feedback for skipping
            feedbackElement.textContent = 'Question Skipped.';
            feedbackElement.style.color = '#ffc107'; // Yellow/Orange color for skipped feedback

            // Highlight the correct answer button visually (if it exists)
             const answerButtonsList = answerButtonsElement.querySelectorAll('.answer-button');
            if (question.correctAnswer !== undefined && question.correctAnswer >= 0 && question.correctAnswer < answerButtonsList.length) {
                 answerButtonsList[question.correctAnswer].classList.add('correct');
                 console.log("Highlighted correct answer button."); // Debug log
            }


            // Display explanation and correct answer with animation
             const explanationHtml = `<strong>Correct Answer:</strong> ${question.correctAnswerText}<br><br><strong>Explanation:</strong> ${question.explanation}`;
             explanationTextElement.innerHTML = explanationHtml; // Use innerHTML
            explanationAreaElement.classList.remove('hidden');
            setTimeout(() => {
                explanationAreaElement.classList.add('visible');
                 console.log("Explanation area visible after skipping."); // Debug log
            }, 10);

            // *** Do NOT show "Add to Remember" button if skipped ***
            console.log("Skipped. Hiding 'Add to Remember' button."); // Debug log
            addToRememberButton.classList.add('hidden');


            // Determine next action after a delay
            if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                setTimeout(() => {
                    nextButton.classList.remove('hidden');
                     console.log("Showing Next button after skipping."); // Debug log
                }, 800); // Faster timeout
            } else {
                 console.log("Last question skipped. Ending game soon."); // Debug log
                setTimeout(endGame, 1200);
            }
             console.log("skipQuestion() finished."); // Debug log
        }

        // Function to check and set the state of the "Add to Remember" button
        function checkRememberButtonState(question) {
            console.log(`Executing checkRememberButtonState() for Original #${question.originalNumber}`); // Debug log
            // Check if the current question is already in the remember list
            const isAlreadyAdded = questionsToRemember.some(q => q.originalNumber === question.originalNumber && q.topic === question.topic);

            if (isAlreadyAdded) {
                console.log("Question found in remember list. Disabling button."); // Debug log
                addToRememberButton.textContent = "Added!";
                addToRememberButton.disabled = true;
                 // Styling is handled by the CSS :disabled rule now
            } else {
                 console.log("Question NOT found in remember list. Enabling button."); // Debug log
                addToRememberButton.textContent = "Add to Remember List";
                addToRememberButton.disabled = false;
                 // Styling is handled by the CSS rule for #add-to-remember-button
            }
             console.log("Add to Remember button state after check:", { hidden: addToRememberButton.classList.contains('hidden'), disabled: addToRememberButton.disabled, text: addToRememberButton.textContent }); // Debug log
        }


        // Function to add the current question to the remember list when button is clicked
        // This function is now called *only* when the 'Add to Remember List' button is explicitly clicked.
        function addToRememberList() {
             console.log("Executing addToRememberList()"); // Debug log
            const question = currentTopicQuestions[currentQuestionIndex];
            // Check if the current question is already in the remember list before adding
            const isAlreadyAdded = questionsToRemember.some(q => q.originalNumber === question.originalNumber && q.topic === question.topic);

            if (!isAlreadyAdded) {
                // Add a copy of the current question object with a flag
                 questionsToRemember.push({...question, isRememberedItem: true}); // Use spread to copy properties

                // Update button state immediately
                console.log(`Question Original #${question.originalNumber} clicked to add to remember list.`); // Debug log
                checkRememberButtonState(question); // This will set the text to "Added!" and disable the button
                console.log(`Question Original #${question.originalNumber} added to remember list. List size: ${questionsToRemember.length}`); // Debug log
            } else {
                 console.log(`Attempted to add Question Original #${question.originalNumber}, but it was already in the list.`); // Debug log
            }
            // If it was already added, the button should have been disabled already by checkRememberButtonState
             console.log("addToRememberList() finished."); // Debug log
        }


        function nextQuestion() {
            console.log("Executing nextQuestion()."); // Debug log
            currentQuestionIndex++;
            if (currentQuestionIndex < currentTopicQuestions.length) {
                displayQuestion(); // displayQuestion will handle showing/enabling buttons based on type
                displayRandomQuote();
            } else {
                // Should be handled by selectAnswer/skipQuestion/handleSelfCorrection, but included for safety
                 console.log("nextQuestion() called but it's the last question. Calling endGame."); // Debug log
                endGame();
            }
             console.log("nextQuestion() finished."); // Debug log
        }

        function endGame() {
            console.log("Executing endGame()."); // Debug log
            gameInProgress = false;
            // Hide game elements
            questionAreaElement.classList.add('hidden');
            feedbackElement.classList.add('hidden');
            explanationAreaElement.classList.add('hidden');
            explanationAreaElement.classList.remove('visible');
            scoreAreaElement.classList.add('hidden');
            nextButton.classList.add('hidden');
            skipButton.classList.add('hidden'); // Ensure skip button is hidden at the end
            addToRememberButton.classList.add('hidden'); // Ensure remember button is hidden at the end
             essaySelfCorrectionButtonsElement.classList.add('hidden'); // Ensure essay buttons are hidden at the end
             revealAnswerButton.classList.add('hidden'); // Ensure reveal button is hidden at the end
            quoteAreaElement.classList.add('hidden');
            questionCounterElement.classList.add('hidden');


            // Show final score and restart button
            finalScoreElement.classList.remove('hidden');
            finalScoreTextElement.textContent = score;
            finalTotalTextElement.textContent = currentTopicQuestions.length;
            restartButton.classList.remove('hidden');

            // Show Review PDF button only if there were mistakes, skips, or items to remember
             // lessonAttempts contains incorrect MCQs, skipped MCQs, and self-corrected wrong Essays
             // questionsToRemember contains correct MCQs added (if button clicked), and self-corrected correct Essays added (if button clicked)
             console.log(`End Game Summary: Attempts=${lessonAttempts.length}, Remembered=${questionsToRemember.length}`); // Debug log
            if (lessonAttempts.length > 0 || questionsToRemember.length > 0) {
                downloadPdfButton.classList.remove('hidden');
                console.log("Showing Download Review PDF button."); // Debug log
            } else {
                downloadPdfButton.classList.add('hidden');
                 console.log("Hiding Download Review PDF button (no items in review/remember lists)."); // Debug log
            }

            // Always show the Export All button on the final screen
            exportAllPdfButton.classList.remove('hidden');
             console.log("Showing Export All Questions PDF button."); // Debug log
             console.log("endGame() finished."); // Debug log
        }

        function displayRandomQuote() {
            // Only display quote if game is in progress
            if (gameInProgress) {
                const randomIndex = Math.floor(Math.random() * quotes.length);
                currentQuoteElement.textContent = quotes[randomIndex];
                quoteAreaElement.classList.remove('hidden');
            } else {
                quoteAreaElement.classList.add('hidden'); // Hide if not in game
            }
        }

        // Common CSS styles for PDF content - Updated font sizes
        const pdfStyles = `
             <style>
                 body { font-family: 'Arial', sans-serif; line-height: 1.4; color: #333; margin: 0; padding: 0; } /* Removed padding from body, add to html2pdf margin */
                 h1, h2 { color: #1a2a6c; }
                 h1 { font-size: 18pt; margin-bottom: 5mm; }
                 h2 { font-size: 14pt; margin-bottom: 10mm; }
                 p { margin: 0 0 8px 0; }
                 strong { font-weight: bold; }
                 ul { margin: 8px 0 8px 20px; padding: 0; list-style: none; }
                 li { margin-bottom: 4px; font-size: 12pt; } /* Increased font size for options list items */
                 .item-container {
                     border: 1px solid #eee;
                     padding: 15px;
                     margin-bottom: 20px;
                     border-radius: 5px;
                     page-break-inside: avoid; /* Ensures item tries not to break across pages */
                 }
                 .item-header { font-size: 11pt; font-weight: bold; margin-bottom: 10px; color: #444; } /* Increased font size for header */
                 .question-text { font-size: 14pt; margin-bottom: 8px; } /* Increased font size for question text */
                 .answer-text { font-size: 12pt; } /* Increased font size for answer text */
                 .correct-answer { color: #28a745; }
                 .incorrect-answer { color: #dc3545; }
                 .skipped-answer { color: #6c757d; font-style: italic; }
                  .self-corrected-wrong { color: #dc3545; font-style: italic; }
                 .explanation-text { font-size: 11pt; color: #1b5e20; margin-top: 8px; } /* Increased font size for explanation */
                 /* Basic sub/sup styling */
                 sub, sup { font-size: 0.7em; line-height: 0; position: relative; vertical-align: baseline; }
                 sup { top: -0.5em; }
                 sub { bottom: -0.2em; }

                 /* Section Titles */
                 .section-title { font-size: 16pt; font-weight: bold; margin-top: 15mm; margin-bottom: 8mm; }
                 .section-title.attempts { color: #dc3545; }
                 .section-title.remember { color: #4a69bd; }
             </style>
         `;


        // Helper function to generate the HTML content for a single item in the PDF
        // It now handles different question types and sources (attempts vs remembered vs all)
        function buildItemHtml(item, index, isReview = true) {
            // Styles are now defined outside and included in the main HTML string

            let itemHtml = `<div class="item-container">`;

             // Determine how to display the item based on context (Review vs All) and type (MCQ vs Essay)

            if (isReview) {
                 // --- Building for Review PDF (Mistakes/Skips/Remembered) ---
                 // Item comes from either lessonAttempts or questionsToRemember
                 const isRemembered = !!item.isRememberedItem; // Check the flag

                 itemHtml += `<p class="item-header">Item ${index + 1}: (Original Question ${item.originalNumber}, ${item.type.toUpperCase()})</p>`; // Add type here
                 itemHtml += `<p class="question-text"><strong>Question:</strong> ${item.questionText || item.question}</p>`; // Use questionText from attempt if available, otherwise question from original

                 if (item.type === 'mcq') {
                      // Display for MCQ in review (Incorrect/Skipped - from lessonAttempts)
                      // Or Remembered MCQ (from questionsToRemember)
                      if (isRemembered) {
                           // For remembered MCQs, just show the options with correct highlighted below the question
                           if (item.options && Array.isArray(item.options) && item.options.length > 0) {
                                itemHtml += `<p style="margin-bottom: 5px;"><strong>Options:</strong></p><ul>`;
                                item.options.forEach((opt, idx) => {
                                     let optClass = '';
                                     // Need original item to get correct index if building from lessonAttempts (though lessonAttempts shouldn't have correct MCQs unless skipped?)
                                     // If item is from questionsToRemember, it has the original properties including correctAnswer
                                     if (item.hasOwnProperty('correctAnswer') && idx === item.correctAnswer) {
                                         optClass = 'correct-answer';
                                     }
                                     itemHtml += `<li class="${optClass}">${String.fromCharCode(97 + idx)}) ${opt}</li>`;
                                });
                                itemHtml += `</ul>`;
                           }
                      } else { // Must be from lessonAttempts (incorrect or skipped MCQ)
                          if (item.selectedAnswer === "[Skipped]") {
                             itemHtml += `<p class="answer-text skipped-answer"><strong>Your Action:</strong> [Skipped]</p>`;
                         } else if (item.selectedAnswer) { // Was an incorrect attempt
                             itemHtml += `<p class="answer-text incorrect-answer"><strong>Your Answer:</strong> ${item.selectedAnswer}</p>`;
                         }
                          // Also show all options for context on incorrect/skipped MCQs
                          if (item.options && Array.isArray(item.options) && item.options.length > 0) {
                                itemHtml += `<p style="margin-bottom: 5px;"><strong>Options:</strong></p><ul>`;
                                item.options.forEach((opt, idx) => {
                                     let optClass = '';
                                     // Need original item to get correct index - attempt object should ideally store correct index or answer text
                                     // The attempt object stores correctAnswerText, so compare against that
                                     if (item.correctAnswerText && opt === item.correctAnswerText.trim()) { // Trim to match "c) generator" vs "c) generator "
                                         optClass = 'correct-answer';
                                     }
                                     itemHtml += `<li class="${optClass}">${String.fromCharCode(97 + idx)}) ${opt}</li>`;
                                });
                                itemHtml += `</ul>`;
                           }
                      }

                 } else if (item.type === 'essay') {
                     // Display for Essay in review (Self-corrected Wrong - from lessonAttempts or Remembered - from questionsToRemember)
                     if (!isRemembered) { // Must be a self-corrected wrong attempt from lessonAttempts
                         itemHtml += `<p class="answer-text self-corrected-wrong"><strong>Your Action:</strong> [Self-Corrected as Wrong]</p>`;
                     }
                     // If it's a remembered essay (isRememberedItem: true), no user action text is shown here,
                     // just the question, model answer, and explanation below.
                 }

                 // Always show the correct/model answer in the review PDF
                 // For MCQs coming from lessonAttempts, correctAnswerText is stored.
                 // For items coming from questionsToRemember, correctAnswerText is on the item itself (copied from original).
                 itemHtml += `<p class="answer-text correct-answer"><strong>Correct/Model Answer:</strong> ${item.correctAnswerText}</p>`;

                 // Always show the explanation in the review PDF
                 itemHtml += `<p class="explanation-text"><strong>Explanation:</strong> ${item.explanation}</p>`;


            } else {
                 // --- Building for All Questions PDF ---
                 // Item comes directly from allQuestions
                 const question = item; // Use the original question object directly

                 itemHtml += `<p class="item-header">Question ${question.originalNumber}: (${question.type.toUpperCase()})</p>`; // Add type here
                 itemHtml += `<p class="question-text"><strong>Question:</strong> ${question.question}</p>`;

                 if (question.type === 'mcq') {
                     // Add options list for MCQ
                     if (question.options && Array.isArray(question.options) && question.options.length > 0) {
                          itemHtml += `<p style="margin-bottom: 5px;"><strong>Options:</strong></p><ul>`;
                          question.options.forEach((opt, idx) => {
                              let optClass = '';
                              if (question.hasOwnProperty('correctAnswer') && idx === question.correctAnswer) {
                                   optClass = 'correct-answer';
                              }
                              itemHtml += `<li class="${optClass}">${String.fromCharCode(97 + idx)}) ${opt}</li>`;
                          });
                          itemHtml += `</ul>`;
                     }
                     // Add correct answer text explicitly
                      if (question.correctAnswerText) {
                         itemHtml += `<p class="answer-text correct-answer"><strong>Correct Answer:</strong> ${question.correctAnswerText}</p>`;
                     }


                 } else if (question.type === 'essay') {
                      // Add model answer for Essay
                      if (question.correctAnswerText) {
                         itemHtml += `<p class="answer-text correct-answer"><strong>Model Answer:</strong> ${question.correctAnswerText}</p>`;
                     }
                 }

                 // Add explanation
                 if (question.explanation) {
                    itemHtml += `<p class="explanation-text"><strong>Explanation:</strong> ${question.explanation}</p>`;
                 }
            }


            itemHtml += `</div>`; // Close item-container

             return itemHtml; // Return HTML without styles
        }


        // PDF Generation Function for Mistakes, Skips, and Remembered Items using html2pdf.js
        function generateReviewPDF() {
             console.log("Executing generateReviewPDF()"); // Debug log
             // lessonAttempts contains incorrect MCQs, skipped MCQs, and self-corrected wrong Essays
             // questionsToRemember contains correct MCQs added (if button clicked), and self-corrected correct Essays added (if button clicked)

            if (lessonAttempts.length === 0 && questionsToRemember.length === 0) {
                alert("No mistakes, skips, or items added to the 'Remember' list to review.");
                console.log("generateReviewPDF() aborted: No items to include."); // Debug log
                return;
            }

            const topicName = currentTopicQuestions.length > 0 ? currentTopicQuestions[0].topic : 'Lesson';
            console.log(`Generating Review PDF for ${topicName}...`); // Debug log

            let pdfHtml = `
                <html>
                <head>
                    <title>${topicName} Review</title>
                    ${pdfStyles} <!-- Include styles here -->
                </head>
                <body>
                    <h1>Review - Mistakes, Skips, and Remembered Items</h1>
                    <h2>Lesson: ${topicName}</h2>
                    <p><strong>Final Score:</strong> ${score} / ${currentTopicQuestions.length}</p>
            `;

            // --- Incorrect Answers & Skips & Self-Corrected Wrong Section ---
            if (lessonAttempts.length > 0) {
                pdfHtml += `<h2 class="section-title attempts">Incorrect Answers, Skips & Self-Corrected Wrong (${lessonAttempts.length})</h2>`;
                 // Sort attempts by original question number before adding to PDF
                 const sortedAttempts = lessonAttempts.slice().sort((a, b) => a.originalNumber - b.originalNumber);
                sortedAttempts.forEach((item, index) => {
                    pdfHtml += buildItemHtml(item, index, true); // true for isReview
                });
                 console.log(`${lessonAttempts.length} items added to Attempts section of PDF.`); // Debug log
            }

            // --- Questions to Remember Section ---
            if (questionsToRemember.length > 0) {
                 // Add a little space before this section if the previous one exists
                 if (lessonAttempts.length > 0) {
                     pdfHtml += `<div style="height: 10mm;"></div>`; // Add vertical space
                 }
                pdfHtml += `<h2 class="section-title remember">Questions to Remember (${questionsToRemember.length})</h2>`;
                 // Sort remembered items by original question number
                 const sortedRemembered = questionsToRemember.slice().sort((a, b) => a.originalNumber - b.originalNumber);
                sortedRemembered.forEach((item, index) => {
                     // For remembered items, use buildItemHtml in review mode.
                     // The item object already has the necessary structure (question, type, etc.)
                    pdfHtml += buildItemHtml(item, index, true); // true for isReview
                });
                 console.log(`${questionsToRemember.length} items added to Remember section of PDF.`); // Debug log
            }

            pdfHtml += `</body></html>`;

            // Use html2pdf.js to generate and save the PDF
            const worker = html2pdf().from(pdfHtml).set({
                margin: 5, // Page margins in mm
                filename: `${topicName.replace(/[^a-z0-9]/gi, '_')}_Review.pdf`,
				pagebreak:{mode:"css"}, // Use css mode for page breaks
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 2, // Keep scale 8 for now, reduce if still issues with white pages or memory
                    logging: true,
                    dpi: 300, // Higher DPI for better text rendering
                    letterRendering: true, // Improve text rendering
                    useCORS: true // Needed if any images are from external domains (unlikely here, but good practice)
                },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            });

             worker.save().then(() => {
                 console.log("PDF Generation complete."); // Debug log
             }).catch(error => {
                 console.error("PDF Generation failed:", error); // Debug log
                 alert("Failed to generate PDF. Please check the console for errors.");
             });
             console.log("PDF Generation initiated."); // Debug log
        }


        // PDF Generation Function for ALL Questions using html2pdf.js
        function generateAllQuestionsPDF() {
             console.log("Executing generateAllQuestionsPDF()"); // Debug log
             if (currentTopicQuestions.length === 0) {
                alert("No questions available for the current lesson.");
                 console.log("generateAllQuestionsPDF() aborted: No questions available."); // Debug log
                return;
            }

            const topicName = currentTopicQuestions.length > 0 ? currentTopicQuestions[0].topic : 'Lesson';
             console.log(`Generating All Questions PDF for ${topicName}...`); // Debug log

            let pdfHtml = `
                <html>
                <head>
                    <title>${topicName} All Questions</title>
                     ${pdfStyles} <!-- Include styles here -->
                </head>
                <body>
                    <h1>All Questions and Answers</h1>
                    <h2>Lesson: ${topicName}</h2>
            `;

             // Sort questions just in case they weren't filtered/sorted earlier (though startGame does this)
             const sortedQuestions = currentTopicQuestions.slice().sort((a, b) => a.originalNumber - b.originalNumber);

            // Add each question to the HTML
             sortedQuestions.forEach((item, index) => {
                pdfHtml += buildItemHtml(item, index, false); // false for not isReview (i.e., building for All Questions)
            });
             console.log(`${sortedQuestions.length} items added to All Questions PDF.`); // Debug log

            pdfHtml += `</body></html>`;


            // Use html2pdf.js to generate and save the PDF
             const worker = html2pdf().from(pdfHtml).set({
                margin: 5, // Page margins in mm
                filename: `${topicName.replace(/[^a-z0-9]/gi, '_')}_All_Questions_and_Answers.pdf`,
                 image: { type: 'jpeg', quality: 0.98 },
				 pagebreak:{mode:"css"}, // Use css mode for page breaks
                 html2canvas: {
                     scale: 2, // Keep scale 8 for now, reduce if still issues with white pages
                     logging: true,
                     dpi: 300,
                     letterRendering: true,
                      useCORS: true // Needed if any images are from external domains
                    },
                 jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            });

             worker.save().then(() => {
                 console.log("PDF Generation complete."); // Debug log
             }).catch(error => {
                 console.error("PDF Generation failed:", error); // Debug log
                 alert("Failed to generate PDF. Please check the console for errors.");
             });
             console.log("PDF Generation initiated."); // Debug log
        }


        // --- Event Listeners ---
        addToRememberButton.addEventListener('click', addToRememberList);
        // revealAnswerButton.addEventListener('click', revealAnswer); // Listener added in displayQuestion now
        skipButton.addEventListener('click', skipQuestion);
        nextButton.addEventListener('click', nextQuestion);
        restartButton.addEventListener('click', showLessonSelection);
        downloadPdfButton.addEventListener('click', generateReviewPDF); // Hook up to the new Review PDF function
        exportAllPdfButton.addEventListener('click', generateAllQuestionsPDF);


        // --- Initial Call to Show Lesson Selection ---
        // Using DOMContentLoaded ensures the script runs after the HTML is fully parsed
        document.addEventListener('DOMContentLoaded', () => {
             console.log("DOMContentLoaded fired. Initializing application."); // Debug log
             showLessonSelection();
             console.log("Initial showLessonSelection() called."); // Debug log
        });
    </script>

</body>

</html>
